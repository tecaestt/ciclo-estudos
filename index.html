<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu ciclo de estudos - by @tecaestt</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #2d3748;
            border-bottom: 3px solid #4a5568;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-field {
            display: flex;
            flex-direction: column;
        }
        
        .input-field label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #34495e;
        }
        
        .input-field input, .input-field select {
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .input-field input:focus, .input-field select:focus {
            outline: none;
            border-color: #4a5568;
        }
        
        .btn {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 85, 104, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #38a169, #2f855a);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #dd6b20, #c05621);
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        
        th {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .resultado {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #38a169;
        }
        
        .resultado h3 {
            color: #38a169;
            margin-top: 0;
        }
        
        .ciclo-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #4a5568;
        }
        
        .ciclo-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #4a5568;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .ciclo-item.atual {
            border-left-color: #38a169;
            background: #f0fff4;
        }
        
        .ciclo-item.concluido {
            border-left-color: #a0aec0;
            background: #f7fafc;
            opacity: 0.7;
        }
        
        .ciclo-info {
            flex: 1;
        }
        
        .ciclo-info h4 {
            margin: 0 0 5px 0;
            color: #2d3748;
        }
        
        .ciclo-info small {
            color: #6c757d;
        }
        
        .ciclo-tempo {
            background: #4a5568;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .ciclo-tempo.atual {
            background: #38a169;
        }
        
        .ciclo-tempo.concluido {
            background: #a0aec0;
        }
        
        .controles {
            text-align: center;
            margin: 20px 0;
        }
        
        .progresso-ciclo {
            background: #ecf0f1;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progresso-fill {
            background: linear-gradient(135deg, #38a169, #2f855a);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #4a5568;
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            color: #2d3748;
            font-size: 1.8em;
        }
        
        .stat-card p {
            margin: 0;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #856404;
            border-left: 4px solid #dd6b20;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #0c5460;
            border-left: 4px solid #4a5568;
        }

        .btn-group-mobile {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .btn-group-mobile .btn {
            margin: 0;
            width: 100%;
        }

        /* Estilos do Cron√¥metro */
        .cronometro-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            text-align: center;
        }

        .cronometro-display {
            margin-bottom: 20px;
        }

        .cronometro-tempo {
            font-size: 3.5em;
            font-weight: 300;
            margin-bottom: 5px;
            font-family: 'Monaco', 'Menlo', monospace;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .cronometro-sessao {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .cronometro-progresso {
            margin: 15px 0;
        }

        .cronometro-barra {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            height: 12px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .cronometro-fill {
            background: linear-gradient(90deg, #4ade80, #22c55e);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 15px;
        }

        .cronometro-meta {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .cronometro-controles {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn-cronometro {
            background: rgba(255,255,255,0.15);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            min-width: 100px;
        }

        .btn-cronometro:hover:not(:disabled) {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-cronometro:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-play {
            background: rgba(34, 197, 94, 0.3) !important;
            border-color: rgba(34, 197, 94, 0.5) !important;
        }

        .btn-pause {
            background: rgba(249, 115, 22, 0.3) !important;
            border-color: rgba(249, 115, 22, 0.5) !important;
        }

        .btn-stop {
            background: rgba(239, 68, 68, 0.3) !important;
            border-color: rgba(239, 68, 68, 0.5) !important;
        }

        .btn-complete {
            background: rgba(139, 92, 246, 0.3) !important;
            border-color: rgba(139, 92, 246, 0.5) !important;
        }

        .cronometro-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            gap: 15px;
        }

        .stat-mini {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            flex: 1;
            backdrop-filter: blur(5px);
        }

        .stat-valor {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .stat-label {
            font-size: 0.8em;
            opacity: 0.8;
        }

        /* Efeito pulsante quando ativo */
        .cronometro-container.ativo {
            animation: pulso 2s infinite;
        }

        @keyframes pulso {
            0%, 100% { 
                box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            }
            50% { 
                box-shadow: 0 10px 30px rgba(102, 126, 234, 0.7), 
                            0 0 20px rgba(102, 126, 234, 0.5);
            }
        }

        /* Responsividade do cron√¥metro */
        @media (max-width: 768px) {
            .cronometro-tempo {
                font-size: 2.5em;
            }
            
            .cronometro-controles {
                gap: 8px;
            }
            
            .btn-cronometro {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 80px;
            }
            
            .cronometro-stats {
                gap: 10px;
                margin-top: 15px;
            }
            
            .stat-mini {
                padding: 8px;
            }
            
            .stat-valor {
                font-size: 1.1em;
            }
            
            .stat-label {
                font-size: 0.7em;
            }
        }

        .grafico-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 30px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .detalhes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
            min-width: 300px;
            max-width: 500px;
            flex: 1;
        }

        .detalhe-item {
            background: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border-left: 4px solid #4a5568;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .detalhe-header {
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .detalhe-info {
            font-size: 12px;
            color: #6c757d;
            line-height: 1.4;
        }

        .progress-bar-small {
            background: #ecf0f1;
            border-radius: 10px;
            height: 6px;
            margin-top: 8px;
            overflow: hidden;
        }

        .progress-bar-small .progress-fill {
            background: #38a169;
            height: 100%;
            transition: width 0.3s ease;
        }

        /* Responsividade Mobile */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 10px;
                min-height: 100vh;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 15px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .input-field input, .input-field select {
                padding: 14px 12px;
                font-size: 16px; /* Previne zoom no iOS */
                border-radius: 6px;
            }
            
            .btn {
                padding: 14px 20px;
                font-size: 14px;
                margin: 8px 4px;
                width: 100%;
                max-width: none;
                border-radius: 6px;
            }
            
            .section {
                margin-bottom: 25px;
            }
            
            .section h2 {
                font-size: 1.3em;
                margin-bottom: 15px;
            }
            
            .table-container {
                margin: 15px -15px; /* Expans√£o para as bordas */
                border-radius: 0;
            }
            
            table {
                font-size: 14px;
                border-radius: 0;
            }
            
            th, td {
                padding: 10px 8px;
                font-size: 13px;
            }
            
            .ciclo-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                padding: 12px;
            }
            
            .ciclo-info {
                width: 100%;
            }
            
            .ciclo-info h4 {
                font-size: 14px;
                margin-bottom: 4px;
            }
            
            .ciclo-info small {
                font-size: 12px;
                display: block;
                margin-top: 4px;
            }
            
            .ciclo-tempo {
                align-self: flex-end;
                margin-left: 0;
                margin-top: 8px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-card {
                padding: 15px 10px;
                text-align: center;
            }
            
            .stat-card h3 {
                font-size: 1.4em;
                margin-bottom: 5px;
            }
            
            .stat-card p {
                font-size: 0.8em;
            }
            
            .grafico-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            
            .detalhes-grid {
                grid-template-columns: 1fr;
                max-width: 100%;
                width: 100%;
            }
            
            .detalhe-item {
                padding: 10px;
                margin: 6px 0;
            }
            
            .detalhe-header {
                font-size: 13px;
            }
            
            .detalhe-info {
                font-size: 11px;
                line-height: 1.3;
            }
            
            .resultado {
                padding: 15px;
                margin: 15px 0;
            }
            
            .resultado h3 {
                font-size: 1.1em;
                margin-bottom: 8px;
            }
            
            .warning, .info {
                padding: 12px;
                margin: 12px 0;
                font-size: 14px;
                line-height: 1.4;
            }
            
            .ciclo-container {
                padding: 15px;
                margin: 15px 0;
            }
            
            .progresso-ciclo {
                height: 16px;
                margin: 12px 0;
            }
            
            .controles {
                margin: 15px 0;
            }
            
            /* Canvas do gr√°fico responsivo */
            #graficoPizza {
                max-width: 100%;
                height: auto;
            }
            
            /* Melhorar bot√µes no mobile */
            .btn-group-mobile {
                display: flex;
                flex-direction: column;
                gap: 8px;
                margin: 15px 0;
            }
            
            /* Ajustar inputs de arquivo */
            input[type="file"] {
                padding: 10px;
                border: 2px dashed #4a5568;
                border-radius: 6px;
                background: #f8f9fa;
                width: 100%;
            }
            
            /* Melhorar legenda do gr√°fico no mobile */
            #legendaGrafico {
                max-width: 100% !important;
                width: 100%;
            }
            
            /* Ajustar overflow de tabelas */
            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Melhorar campos de sele√ß√£o */
            select {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                background-image: url('data:image/svg+xml;utf8,<svg fill="%23999" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
                background-repeat: no-repeat;
                background-position: right 8px center;
                padding-right: 35px;
            }
        }
        
        /* Melhorias espec√≠ficas para telas muito pequenas */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .btn {
                padding: 12px 16px;
                font-size: 13px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .input-group {
                gap: 10px;
            }
            
            .content {
                padding: 10px;
            }
            
            .section {
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Ciclo de Estudos</h1>
    <p>Pra voc√™ que confiou na minha ajuda, quero te mostrar na pr√°tica como funciona!</p>
        </div>
        
        <div class="content">
            <!-- Configura√ß√£o B√°sica -->
            <div class="section">
                <h2>‚öôÔ∏è Configura√ß√£o B√°sica</h2>
                <div class="input-group">
                    <div class="input-field">
                        <label>Horas dispon√≠veis (Segunda a Sexta)</label>
                        <input type="number" id="horasSegSex" value="2" min="0.5" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Horas dispon√≠veis (S√°bado)</label>
                        <input type="number" id="horasSabado" value="4" min="0" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Horas dispon√≠veis (Domingo)</label>
                        <input type="number" id="horasDomingo" value="3" min="0" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Dura√ß√£o da sess√£o (minutos)</label>
                        <select id="duracaoSessao" onchange="calcularSessoesPorDia()">
                            <option value="30">30 min (Iniciante)</option>
                            <option value="45" selected>45 min (Intermedi√°rio)</option>
                            <option value="60">60 min (Avan√ßado)</option>
                            <option value="90">90 min (Expert)</option>
                        </select>
                    </div>
                    <div class="input-field">
                        <label>Pausa entre sess√µes (minutos)</label>
                        <input type="number" id="pausaSessao" value="10" min="5" max="30" onchange="calcularSessoesPorDia()">
                    </div>
                </div>
                <div class="resultado">
                    <h3>üìä Horas semanais: <span id="horasSemanais">19</span>h | Sess√µes: <span id="sessoesSemanais">25</span></h3>
                    <p>üí° Tempo produtivo: <span id="tempoLiquido">18h45</span> | Tempo total com pausas: <span id="tempoTotal">19h00</span></p>
                </div>
            </div>

            <!-- Cadastro de Mat√©rias -->
            <div class="section">
                <h2>üìö Cadastro de Mat√©rias</h2>
                <div class="input-group">
                    <div class="input-field">
                        <label>Nome da Mat√©ria</label>
<select id="nomeMateria" onchange="toggleMateriaCustomizada()">
  <option value="">Selecione uma mat√©ria</option>
  <option value="Administra√ß√£o Geral">Administra√ß√£o Geral</option>
  <option value="Administra√ß√£o P√∫blica">Administra√ß√£o P√∫blica</option>
  <option value="Arquivologia">Arquivologia</option>
  <option value="Auditoria">Auditoria</option>
  <option value="Biologia">Biologia</option>
  <option value="Com√©rcio Internacional">Com√©rcio Internacional</option>
  <option value="Contabilidade Geral e P√∫blica">Contabilidade Geral e P√∫blica</option>
  <option value="Criminologia">Criminologia</option>
  <option value="Dire√ß√£o Defensiva">Dire√ß√£o Defensiva</option>
  <option value="Direito Administrativo">Direito Administrativo</option>
  <option value="Direito Civil">Direito Civil</option>
  <option value="Direito Constitucional">Direito Constitucional</option>
  <option value="Direito do Trabalho">Direito do Trabalho</option>
  <option value="Direito Penal">Direito Penal</option>
  <option value="Direito Previdenci√°rio">Direito Previdenci√°rio</option>
  <option value="Direito Processual Civil">Direito Processual Civil</option>
  <option value="Direito Processual do Trabalho">Direito Processual do Trabalho</option>
  <option value="Direito Processual Penal">Direito Processual Penal</option>
  <option value="Direito Tribut√°rio">Direito Tribut√°rio</option>
  <option value="Direitos Humanos">Direitos Humanos</option>
  <option value="Economia e Finan√ßas P√∫blicas">Economia e Finan√ßas P√∫blicas</option>
  <option value="Estat√≠stica">Estat√≠stica</option>
  <option value="√âtica e Cidadania">√âtica e Cidadania</option>
  <option value="F√≠sica">F√≠sica</option>
  <option value="Flu√™ncia em Dados">Flu√™ncia em Dados</option>
  <option value="Geopol√≠tica">Geopol√≠tica</option>
  <option value="Gest√£o de Pessoas">Gest√£o de Pessoas</option>
  <option value="Hist√≥ria da PRF">Hist√≥ria da PRF</option>
  <option value="Inform√°tica">Inform√°tica</option>
  <option value="Legisla√ß√£o Aduaneira">Legisla√ß√£o Aduaneira</option>
  <option value="Legisla√ß√£o de Tr√¢nsito">Legisla√ß√£o de Tr√¢nsito</option>
  <option value="Legisla√ß√£o Especial">Legisla√ß√£o Especial</option>
  <option value="Legisla√ß√£o Penal Especial">Legisla√ß√£o Penal Especial</option>
  <option value="Legisla√ß√£o Tribut√°ria">Legisla√ß√£o Tribut√°ria</option>
  <option value="L√≠ngua Inglesa">L√≠ngua Inglesa</option>
  <option value="L√≠ngua Portuguesa">L√≠ngua Portuguesa</option>
  <option value="No√ß√µes de Direitos Humanos e Acessibilidade">No√ß√µes de Direitos Humanos e Acessibilidade</option>
  <option value="No√ß√µes de Sustentabilidade">No√ß√µes de Sustentabilidade</option>
  <option value="Primeiros Socorros">Primeiros Socorros</option>
  <option value="Qu√≠mica">Qu√≠mica</option>
  <option value="Racioc√≠nio L√≥gico-Matem√°tico">Racioc√≠nio L√≥gico-Matem√°tico</option>
  <option value="Reda√ß√£o Oficial">Reda√ß√£o Oficial</option>
  <option value="Sistemas Operacionais">Sistemas Operacionais</option>
  <option value="‚úèÔ∏è Digitar outra mat√©ria">‚úèÔ∏è Digitar outra mat√©ria</option>
</select>

                        <input type="text" id="materiaCustomizada" placeholder="Digite o nome da mat√©ria" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="input-field">
                        <label>Peso no Edital (1-10)</label>
                        <input type="number" id="pesoMateria" min="1" max="10" value="5">
                    </div>
                    <div class="input-field">
                        <label>Sua Dificuldade (1-5)</label>
                        <select id="dificuldadeMateria">
                            <option value="1">1 - Muito F√°cil</option>
                            <option value="2">2 - F√°cil</option>
                            <option value="3" selected>3 - M√©dio</option>
                            <option value="4">4 - Dif√≠cil</option>
                            <option value="5">5 - Muito Dif√≠cil</option>
                        </select>
                    </div>
                </div>
                <div class="btn-group-mobile">
                    <button class="btn" onclick="adicionarMateria()">‚ûï Adicionar Mat√©ria</button>
                    <button class="btn btn-success" onclick="gerarCiclo()">üîÑ Gerar Ciclo</button>
                    <button class="btn btn-danger" onclick="limparTudo()">üóëÔ∏è Limpar Tudo</button>
                </div>
            </div>

            <!-- Tabela de Mat√©rias -->
            <div class="section">
                <h2>üìã Mat√©rias Cadastradas</h2>
                <div class="table-container">
                    <table id="tabelaMaterias">
                        <thead>
                            <tr>
                                <th>Mat√©ria</th>
                                <th>Peso</th>
                                <th>Dificuldade</th>
                                <th>Pontua√ß√£o</th>
                                <th>Sess√µes no Ciclo</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Hist√≥rico de Estudos -->
            <div class="section" id="historicoSection" style="display: none;">
                <h2>üìà Hist√≥rico de Estudos</h2>
                <div id="historicoEstatisticas" class="stats"></div>
                <div class="ciclo-container">
                    <h3 style="text-align: center; color: #2d3748; margin-bottom: 20px;">üìÖ √öltimas Sess√µes</h3>
                    <div id="historicoLista" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- Ciclo de Estudos -->
            <div class="section">
                <h2>üîÑ Seu Ciclo de Estudos</h2>
                <div id="cicloInfo" class="info" style="display: none;">
                    <strong>Como funciona:</strong> Siga a sequ√™ncia abaixo na ordem. Quando terminar uma sess√£o, marque como conclu√≠da e continue na pr√≥xima. Quando chegar ao fim, o ciclo recome√ßa automaticamente.
                </div>
                
                <div class="stats" id="statsContainer" style="display: none;">
                    <div class="stat-card">
                        <h3 id="totalSessoes">0</h3>
                        <p>Total de Sess√µes</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="tempoCompletoCiclo">0h</h3>
                        <p>Tempo Completo do Ciclo</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="diasPrevisto">0</h3>
                        <p>Dias para Completar</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="sessaoAtual">0</h3>
                        <p>Sess√£o Atual</p>
                    </div>
                </div>

                <!-- Gr√°fico de Pizza -->
                <div class="ciclo-container" id="graficoContainer" style="display: none;">
                    <h3 style="text-align: center; color: #2d3748; margin-bottom: 20px;">üìä Distribui√ß√£o do Ciclo</h3>
                    <div class="grafico-container">
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                            <canvas id="graficoPizza" width="300" height="300"></canvas>
                            <div id="legendaGrafico" style="max-width: 300px;"></div>
                        </div>
                        <div class="detalhes-grid" id="detalhesGrafico">
                            <h4 style="color: #2d3748; margin-bottom: 15px; grid-column: 1 / -1;">üìà Detalhes por Mat√©ria</h4>
                            <div id="listaDetalhes"></div>
                        </div>
                    </div>
                </div>

                <div class="progresso-ciclo" id="progressoContainer" style="display: none;">
                    <div class="progresso-fill" id="progressoFill" style="width: 0%"></div>
                </div>

                <div class="controles" id="controlesContainer" style="display: none;">

                    
                    <p id="tempoTotalHoje" style="font-weight: bold; font-size: 1.1em;">
  Voc√™ estudou hoje: 0h00min
</p>
<p id="fraseMotivacional" style="font-size: 1.1em; margin-top: 8px; font-style: italic;"></p>



                    
                    
                    <!-- Cron√¥metro de Estudo -->
                    <div class="cronometro-container" id="cronometroContainer">
                        <div class="cronometro-display">
                            <div class="cronometro-tempo" id="cronometroTempo">00:00</div>
                            <div class="cronometro-sessao" id="cronometroSessao">Pr√≥xima sess√£o: Clique em Iniciar</div>
                            <div class="cronometro-progresso">
                                <div class="cronometro-barra">
                                    <div class="cronometro-fill" id="cronometroFill" style="width: 0%"></div>
                                </div>
                                <div class="cronometro-meta" id="cronometroMeta">Meta: --:--</div>
                            </div>
                        </div>
                        <div class="cronometro-controles">
                            <button class="btn-cronometro btn-play" id="btnPlay" onclick="iniciarCronometro()">
                                ‚ñ∂Ô∏è Iniciar Sess√£o
                            </button>
                            <button class="btn-cronometro btn-pause" id="btnPause" onclick="pausarCronometro()" disabled>
                                ‚è∏Ô∏è Pausar
                            </button>
                            <button class="btn-cronometro btn-stop" id="btnStop" onclick="pararCronometro()" disabled>
                                ‚èπÔ∏è Parar
                            </button>
                            <button class="btn-cronometro btn-complete" id="btnComplete" onclick="completarSessao()" disabled>
                                ‚úÖ Concluir
                            </button>
                        </div>
                        <div class="cronometro-stats" id="cronometroStats">
                            <div class="stat-mini">
                                <span class="stat-valor" id="tempoEstudado">0min</span>
                                <span class="stat-label">Estudado hoje</span>
                            </div>
                            <div class="stat-mini">
                                <span class="stat-valor" id="sessoesHoje">0</span>
                                <span class="stat-label">Sess√µes hoje</span>
                            </div>
                            <div class="stat-mini">
                                <span class="stat-valor" id="streakDias">0</span>
                                <span class="stat-label">Dias seguidos</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-success" onclick="marcarConcluida()">‚úÖ Marcar Sess√£o Atual como Conclu√≠da</button>
                        <button class="btn btn-warning" onclick="reiniciarCiclo()">üîÑ Reiniciar Ciclo</button>
                        <button class="btn" onclick="imprimirCiclo()">üñ®Ô∏è Imprimir Checklist</button>
                    </div>
                </div>

                <div class="ciclo-container" id="cicloContainer">
                    <p style="text-align: center; color: #6c757d; font-style: italic;">
                        Adicione mat√©rias e clique em "Gerar Ciclo" para come√ßar
                    </p>
                </div>
            </div>

            <!-- Instru√ß√µes -->
            <div class="section">
                <h2>üìñ Como Usar</h2>
                <div class="warning">
                    <strong>üéØ Princ√≠pios do Ciclo de Estudos:</strong><br>
                    ‚Ä¢ <strong>Sequ√™ncia Rotativa:</strong> Siga a ordem das mat√©rias, n√£o dias da semana<br>
                    ‚Ä¢ <strong>Continuidade:</strong> Quando terminar uma sess√£o, continue na pr√≥xima (mesmo que seja outro dia)<br>
                    ‚Ä¢ <strong>Flexibilidade:</strong> Se n√£o conseguir estudar hoje, continue de onde parou amanh√£<br>
                    ‚Ä¢ <strong>Prioriza√ß√£o Inteligente:</strong> Mat√©rias importantes aparecem mais vezes no ciclo<br>
                    ‚Ä¢ <strong>Dura√ß√£o Adaptativa:</strong> Mat√©rias mais dif√≠ceis e importantes t√™m sess√µes mais longas<br>
                    ‚Ä¢ <strong>Sem Ac√∫mulo:</strong> N√£o h√° "mat√©ria atrasada" - apenas continue o ciclo
                </div>
                
                <div class="info">
                    <strong>üìù Passos para usar:</strong><br>
                    1. Configure suas horas dispon√≠veis por dia e dura√ß√£o base das sess√µes<br>
                    2. Adicione suas mat√©rias com pesos e dificuldades<br>
                    3. Clique em "Gerar Ciclo" para criar sua sequ√™ncia personalizada<br>
                    4. Estude seguindo a ordem das sess√µes (cada uma tem dura√ß√£o espec√≠fica)<br>
                    5. Marque cada sess√£o como conclu√≠da quando terminar<br>
                    6. Quando chegar ao fim, o ciclo recome√ßa automaticamente
                </div>
                
                <div class="info">
                    <strong>‚è±Ô∏è Sobre as dura√ß√µes das sess√µes:</strong><br>
                    ‚Ä¢ <strong>Dura√ß√£o Base:</strong> Valor configurado acima (ex: 45 min)<br>
                    ‚Ä¢ <strong>Fator Peso:</strong> Mat√©rias mais importantes (peso 8-10) ganham +20% de tempo<br>
                    ‚Ä¢ <strong>Fator Dificuldade:</strong> Mat√©rias mais dif√≠ceis (4-5) ganham +30% de tempo<br>
                    ‚Ä¢ <strong>Exemplo:</strong> Mat√©ria peso 8, dificuldade 4 = 45min √ó 1.16 √ó 1.24 = 65min<br>
                    ‚Ä¢ <strong>Arredondamento:</strong> Todas as dura√ß√µes s√£o m√∫ltiplos de 5 minutos
                </div>
                
                <div class="warning">
                    <strong>üß† Curva do Esquecimento:</strong><br>
                    ‚Ä¢ <strong>Frequ√™ncia M√≠nima:</strong> Todas as mat√©rias aparecem pelo menos 2x por semana<br>
                    ‚Ä¢ <strong>Intervalo M√°ximo:</strong> Nenhuma mat√©ria fica mais de 8 sess√µes sem aparecer<br>
                    ‚Ä¢ <strong>Revis√£o Autom√°tica:</strong> Mat√©rias mais dif√≠ceis/importantes aparecem com menor intervalo<br>
                    ‚Ä¢ <strong>Distribui√ß√£o Inteligente:</strong> Sistema evita lacunas que causam esquecimento<br>
                    ‚Ä¢ <strong>Prioridade Din√¢mica:</strong> Mat√©rias que est√£o h√° mais tempo sem aparecer ganham prioridade
                </div>
                
                <div class="info">
                    <strong>üíæ Salvamento Autom√°tico:</strong><br>
                    ‚Ä¢ <strong>Dados salvos:</strong> Mat√©rias, progresso do ciclo, hist√≥rico de estudos<br>
                    ‚Ä¢ <strong>Backup manual:</strong> Use "Exportar Dados" para criar backup<br>
                    ‚Ä¢ <strong>Transferir dispositivos:</strong> Exporte em um dispositivo, importe em outro<br>
                    ‚Ä¢ <strong>Sem perda:</strong> Seus dados ficam salvos mesmo fechando o navegador
                </div>
            </div>

            <!-- Controles de Dados -->
            <div class="section" id="dadosSection" style="display: none;">
                <h2>üíæ Gerenciar Dados</h2>
                <div class="ciclo-container">
                    <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button class="btn" onclick="exportarDados()">üì§ Exportar Dados</button>
                        <button class="btn" onclick="document.getElementById('importarArquivo').click()">üì• Importar Dados</button>
                        <button class="btn btn-danger" onclick="limparHistorico()">üóëÔ∏è Limpar Hist√≥rico</button>
                        <input type="file" id="importarArquivo" accept=".json" style="display: none;" onchange="importarDados(event)">
                    </div>
                    <div style="text-align: center; color: #6c757d; font-size: 0.9em;">
                        <p>üí° Seus dados s√£o salvos automaticamente no navegador</p>
                        <p>üì± Use exportar/importar para backup ou transferir entre dispositivos</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let materias = [];
        let cicloAtual = [];
        let sessaoAtualIndex = 0;
        let sessoesConcluidas = 0;
        let historicoEstudos = [];
        let estatisticasGerais = {
            totalSessoes: 0,
            totalTempo: 0,
            ciclosCompletos: 0,
            tempoTotalPorMateria: {}
        };

        // Vari√°veis do cron√¥metro
        let cronometroAtivo = false;
        let cronometroPausado = false;
        let tempoInicio = 0;
        let tempoDecorrido = 0;
        let tempoMeta = 0;
        let intervaloCronometro = null;
        let sessaoAtual = null;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            verificarLocalStorage();
            carregarDados();
            calcularSessoesPorDia();
        });

        // Fun√ß√£o para verificar se localStorage est√° funcionando
        function verificarLocalStorage() {
            try {
                const teste = 'teste_localStorage';
                localStorage.setItem(teste, 'funcionando');
                const resultado = localStorage.getItem(teste);
                localStorage.removeItem(teste);
                
                if (resultado === 'funcionando') {
                    console.log('‚úÖ LocalStorage funcionando corretamente');
                    
                    // Mostrar status na p√°gina
                    const statusDiv = document.createElement('div');
                    statusDiv.style.cssText = `
                        position: fixed;
                        top: 10px;
                        right: 10px;
                        background: #38a169;
                        color: white;
                        padding: 8px 12px;
                        border-radius: 6px;
                        font-size: 12px;
                        z-index: 1000;
                        opacity: 0.9;
                    `;
                    statusDiv.textContent = 'üíæ Salvamento autom√°tico ativo';
                    document.body.appendChild(statusDiv);
                    
                    // Remover ap√≥s 3 segundos
                    setTimeout(() => {
                        if (statusDiv.parentNode) {
                            statusDiv.parentNode.removeChild(statusDiv);
                        }
                    }, 3000);
                } else {
                    throw new Error('LocalStorage n√£o retornou valor correto');
                }
            } catch (error) {
                console.error('‚ùå LocalStorage n√£o est√° funcionando:', error);
                alert('‚ö†Ô∏è AVISO: O salvamento autom√°tico n√£o est√° funcionando.\n\nIsso pode acontecer se:\n‚Ä¢ Voc√™ estiver no modo privado/inc√≥gnito\n‚Ä¢ O armazenamento local estiver desabilitado\n‚Ä¢ O navegador n√£o suportar localStorage\n\nUse "Exportar Dados" para fazer backup manual.');
            }
        }

        // Fun√ß√£o para mostrar/esconder campo de mat√©ria customizada
        function toggleMateriaCustomizada() {
            const select = document.getElementById('nomeMateria');
            const input = document.getElementById('materiaCustomizada');
            
            if (select.value === 'Outra') {
                input.style.display = 'block';
                input.focus();
            } else {
                input.style.display = 'none';
                input.value = '';
            }
        }

        // Fun√ß√µes de salvamento autom√°tico
        function salvarDados() {
            const dados = {
                materias: materias,
                cicloAtual: cicloAtual,
                sessaoAtualIndex: sessaoAtualIndex,
                sessoesConcluidas: sessoesConcluidas,
                historicoEstudos: historicoEstudos,
                estatisticasGerais: estatisticasGerais,
                dataUltimaSalvamento: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('cicloEstudos', JSON.stringify(dados));
                console.log('‚úÖ Dados salvos automaticamente no navegador');
            } catch (error) {
                console.warn('‚ùå Erro ao salvar dados:', error);
                alert('Erro ao salvar dados. Verifique se o armazenamento local est√° habilitado.');
            }
        }

        function carregarDados() {
            try {
                const dados = localStorage.getItem('cicloEstudos');
                if (dados) {
                    const dadosCarregados = JSON.parse(dados);
                    
                    materias = dadosCarregados.materias || [];
                    cicloAtual = dadosCarregados.cicloAtual || [];
                    sessaoAtualIndex = dadosCarregados.sessaoAtualIndex || 0;
                    sessoesConcluidas = dadosCarregados.sessoesConcluidas || 0;
                    historicoEstudos = dadosCarregados.historicoEstudos || [];
                    estatisticasGerais = dadosCarregados.estatisticasGerais || {
                        totalSessoes: 0,
                        totalTempo: 0,
                        ciclosCompletos: 0,
                        tempoTotalPorMateria: {}



                        const tempoSalvo = localStorage.getItem('tempoDecorrido');
if (tempoSalvo) {
  tempoDecorrido = parseInt(tempoSalvo);
  atualizarVisualCronometro(); // se essa fun√ß√£o j√° existe
}

                    
                    };
                    
                    // Atualizar interface
                    atualizarTabela();
                    atualizarVisualizacaoCiclo();
                    atualizarEstatisticas();
                    atualizarHistorico();
                    atualizarEstatisticasDia();
                    
                    console.log('‚úÖ Dados carregados com sucesso!');
                    
                    // Mostrar notifica√ß√£o de dados carregados
                    if (materias.length > 0) {
                        const ultimaSalvamento = new Date(dadosCarregados.dataUltimaSalvamento).toLocaleString('pt-BR');
                        console.log(`üìÖ √öltima atualiza√ß√£o: ${ultimaSalvamento}`);
                    }
                }
            } catch (error) {
                console.warn('‚ùå Erro ao carregar dados salvos:', error);
            }
        }

        function registrarSessao(materia, duracao) {
            const registro = {
                materia: materia,
                duracao: duracao,
                data: new Date().toISOString(),
                timestamp: Date.now()
            };
            
            historicoEstudos.push(registro);
            
            // Atualizar estat√≠sticas gerais
            estatisticasGerais.totalSessoes++;
            estatisticasGerais.totalTempo += duracao;
            
            if (!estatisticasGerais.tempoTotalPorMateria[materia]) {
                estatisticasGerais.tempoTotalPorMateria[materia] = 0;
            }
            estatisticasGerais.tempoTotalPorMateria[materia] += duracao;
            
            // Salvar automaticamente
            salvarDados();
            atualizarHistorico();
        }

        function atualizarHistorico() {
            const historicoSection = document.getElementById('historicoSection');
            const dadosSection = document.getElementById('dadosSection');
            
            if (historicoEstudos.length === 0) {
                historicoSection.style.display = 'none';
                dadosSection.style.display = 'none';
                return;
            }
            
            historicoSection.style.display = 'block';
            dadosSection.style.display = 'block';
            
            // Atualizar estat√≠sticas
            const estatisticasDiv = document.getElementById('historicoEstatisticas');
            const totalHoras = (estatisticasGerais.totalTempo / 60).toFixed(1);
            const mediaPorDia = historicoEstudos.length > 0 ? 
                (estatisticasGerais.totalTempo / getDiasEstudados()).toFixed(0) : 0;
            
            estatisticasDiv.innerHTML = `
                <div class="stat-card">
                    <h3>${estatisticasGerais.totalSessoes}</h3>
                    <p>Sess√µes Conclu√≠das</p>
                </div>
                <div class="stat-card">
                    <h3>${totalHoras}h</h3>
                    <p>Tempo Total</p>
                </div>
                <div class="stat-card">
                    <h3>${estatisticasGerais.ciclosCompletos}</h3>
                    <p>Ciclos Completos</p>
                </div>
                <div class="stat-card">
                    <h3>${mediaPorDia}min</h3>
                    <p>M√©dia por Dia</p>
                </div>
            `;
            
            // Atualizar lista de hist√≥rico
            const historicoLista = document.getElementById('historicoLista');
            const ultimasSessoes = historicoEstudos.slice(-20).reverse();
            
            let htmlHistorico = '';
            
            ultimasSessoes.forEach(sessao => {
                const data = new Date(sessao.data);
                const dataFormatada = data.toLocaleDateString('pt-BR');
                const horaFormatada = data.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                htmlHistorico += `
                    <div style="background: white; padding: 12px; margin: 8px 0; border-radius: 8px; border-left: 4px solid #4a5568; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${sessao.materia}</strong>
                            <br>
                            <small style="color: #6c757d;">${dataFormatada} √†s ${horaFormatada}</small>
                        </div>
                        <div style="text-align: right;">
                            <span style="background: #4a5568; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                                ${sessao.duracao}min
                            </span>
                        </div>
                    </div>
                `;
            });
            
            historicoLista.innerHTML = htmlHistorico;
        }

        function getDiasEstudados() {
            if (historicoEstudos.length === 0) return 1;
            
            const datas = new Set();
            historicoEstudos.forEach(sessao => {
                const data = new Date(sessao.data).toDateString();
                datas.add(data);
            });
            
            return Math.max(1, datas.size);
        }

        function exportarDados() {
            const dados = {
                materias: materias,
                cicloAtual: cicloAtual,
                sessaoAtualIndex: sessaoAtualIndex,
                sessoesConcluidas: sessoesConcluidas,
                historicoEstudos: historicoEstudos,
                estatisticasGerais: estatisticasGerais,
                dataExportacao: new Date().toISOString(),
                versao: "1.0"
            };
            
            const blob = new Blob([JSON.stringify(dados, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ciclo-estudos-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('Dados exportados com sucesso!');
        }

        function importarDados(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const dados = JSON.parse(e.target.result);
                    
                    // Validar estrutura b√°sica
                    if (!dados.materias || !Array.isArray(dados.materias)) {
                        throw new Error('Arquivo inv√°lido');
                    }
                    
                    // Confirmar importa√ß√£o
                    if (confirm('Isso substituir√° todos os dados atuais. Deseja continuar?')) {
                        materias = dados.materias || [];
                        cicloAtual = dados.cicloAtual || [];
                        sessaoAtualIndex = dados.sessaoAtualIndex || 0;
                        sessoesConcluidas = dados.sessoesConcluidas || 0;
                        historicoEstudos = dados.historicoEstudos || [];
                        estatisticasGerais = dados.estatisticasGerais || {
                            totalSessoes: 0,
                            totalTempo: 0,
                            ciclosCompletos: 0,
                            tempoTotalPorMateria: {}
                        };
                        
                        // Atualizar interface
                        calcularSessoesPorDia();
                        atualizarTabela();
                        atualizarVisualizacaoCiclo();
                        atualizarEstatisticas();
                        atualizarHistorico();
                        
                        // Salvar
                        salvarDados();
                        
                        alert('Dados importados com sucesso!');
                    }
                } catch (error) {
                    alert('Erro ao importar dados. Verifique se o arquivo est√° correto.');
                }
            };
            reader.readAsText(file);
            
            // Limpar input
            event.target.value = '';
        }

        function limparHistorico() {
            if (confirm('Tem certeza que deseja limpar todo o hist√≥rico? Esta a√ß√£o n√£o pode ser desfeita.')) {
                historicoEstudos = [];
                estatisticasGerais = {
                    totalSessoes: 0,
                    totalTempo: 0,
                    ciclosCompletos: 0,
                    tempoTotalPorMateria: {}
                };
                
                salvarDados();
                atualizarHistorico();
                
                alert('Hist√≥rico limpo com sucesso!');
            }
        }

        // Fun√ß√£o para calcular dura√ß√£o da sess√£o baseada na dificuldade e peso
        function calcularDuracaoSessao(peso, dificuldade) {
            const duracaoBase = parseInt(document.getElementById('duracaoSessao').value) || 45;
            
            // Fator de peso (1-10): mat√©rias mais importantes precisam de mais tempo
            const fatorPeso = 0.8 + (peso / 10) * 0.4; // Varia de 0.8 a 1.2
            
            // Fator de dificuldade (1-5): mat√©rias mais dif√≠ceis precisam de mais tempo
            const fatorDificuldade = 0.7 + (dificuldade / 5) * 0.6; // Varia de 0.7 a 1.3
            
            // Calcular dura√ß√£o final
            const duracao = Math.round(duracaoBase * fatorPeso * fatorDificuldade);
            
            // Garantir que seja m√∫ltiplo de 5 minutos para facilitar
            return Math.round(duracao / 5) * 5;
        }

        // Fun√ß√£o para calcular sess√µes semanais
        function calcularSessoesPorDia() {
            const horasSegSex = parseFloat(document.getElementById('horasSegSex').value) || 2;
            const horasSabado = parseFloat(document.getElementById('horasSabado').value) || 4;
            const horasDomingo = parseFloat(document.getElementById('horasDomingo').value) || 3;
            const duracaoSessao = parseInt(document.getElementById('duracaoSessao').value) || 45;
            const pausaSessao = parseInt(document.getElementById('pausaSessao').value) || 10;
            
            const horasSemanais = (horasSegSex * 5) + horasSabado + horasDomingo;
            const minutosSemanais = horasSemanais * 60;
            const tempoTotalPorSessao = duracaoSessao + pausaSessao;
            const sessoesSemanais = Math.floor(minutosSemanais / tempoTotalPorSessao);
            
            const tempoLiquido = (sessoesSemanais * duracaoSessao) / 60;
            
            document.getElementById('horasSemanais').textContent = horasSemanais.toFixed(1);
            document.getElementById('sessoesSemanais').textContent = sessoesSemanais;
            document.getElementById('tempoLiquido').textContent = formatarTempo(tempoLiquido);
            document.getElementById('tempoTotal').textContent = formatarTempo(horasSemanais);
        }

        // Fun√ß√£o para formatar tempo
        function formatarTempo(horas) {
            const h = Math.floor(horas);
            const m = Math.round((horas - h) * 60);
            return `${h}h${m.toString().padStart(2, '0')}`;
        }

        // Fun√ß√£o para adicionar mat√©ria
        function adicionarMateria() {
            console.log('‚ûï Tentando adicionar mat√©ria...');
            
            const selectMateria = document.getElementById('nomeMateria');
            const inputCustomizado = document.getElementById('materiaCustomizada');
            const pesoMateria = document.getElementById('pesoMateria');
            const dificuldadeMateria = document.getElementById('dificuldadeMateria');
            
            let nome = '';
            if (selectMateria.value === 'Outra') {
                nome = inputCustomizado.value.trim();
                console.log(`üìù Mat√©ria customizada: "${nome}"`);
            } else {
                nome = selectMateria.value;
                console.log(`üìö Mat√©ria selecionada: "${nome}"`);
            }
            
            if (!nome) {
                mostrarNotificacao('‚ùå Por favor, selecione ou digite o nome da mat√©ria', 'erro');
                console.log('‚ùå Nome da mat√©ria vazio');
                return;
            }

            // Verifica se j√° existe
            if (materias.some(m => m.nome === nome)) {
                mostrarNotificacao('‚ö†Ô∏è Esta mat√©ria j√° foi adicionada!', 'aviso');
                console.log('‚ö†Ô∏è Mat√©ria duplicada');
                return;
            }

            const peso = parseInt(pesoMateria.value);
            const dificuldade = parseInt(dificuldadeMateria.value);
            const pontuacao = Math.pow(peso, 1.5) * Math.pow(dificuldade, 1.2);
            
            console.log(`üìä Peso: ${peso}, Dificuldade: ${dificuldade}, Pontua√ß√£o: ${pontuacao.toFixed(1)}`);
            
            const materia = {
                nome,
                peso,
                dificuldade,
                pontuacao,
                sessoes: 0
            };

            materias.push(materia);
            console.log(`‚úÖ Mat√©ria adicionada. Total: ${materias.length}`);
            
            // Salvar dados
            salvarDados();
            
            atualizarTabela();
            limparFormulario();
            
            // Notifica√ß√£o discreta
            mostrarNotificacao(`‚úÖ "${nome}" adicionada! Total: ${materias.length} mat√©rias`, 'sucesso');
        }

        function limparFormulario() {
            document.getElementById('nomeMateria').value = '';
            document.getElementById('materiaCustomizada').value = '';
            document.getElementById('materiaCustomizada').style.display = 'none';
            document.getElementById('pesoMateria').value = '5';
            document.getElementById('dificuldadeMateria').value = '3';
        }

        function removerMateria(index) {
            if (confirm('Tem certeza que deseja remover esta mat√©ria?')) {
                materias.splice(index, 1);
                salvarDados();
                atualizarTabela();
                
                // Se h√° um ciclo gerado, regenerar
                if (cicloAtual.length > 0) {
                    gerarCiclo();
                }
            }
        }

        function limparTudo() {
            if (confirm('Tem certeza que deseja limpar todas as mat√©rias e reiniciar?')) {
                materias = [];
                cicloAtual = [];
                sessaoAtualIndex = 0;
                sessoesConcluidas = 0;
                
                salvarDados();
                atualizarTabela();
                atualizarVisualizacaoCiclo();
                atualizarEstatisticas();
                
                alert('Dados limpos com sucesso!');
            }
        }

        // Fun√ß√£o para calcular sess√µes por mat√©ria
        function calcularSessoesPorMateria() {
            const sessoesSemanais = parseInt(document.getElementById('sessoesSemanais').textContent) || 10;
            const totalPontuacao = materias.reduce((sum, m) => sum + m.pontuacao, 0);
            
            // Garantir que cada mat√©ria tenha pelo menos uma frequ√™ncia m√≠nima
            const frequenciaMinima = Math.max(2, Math.ceil(sessoesSemanais / 10)); // M√≠nimo 2 sess√µes ou 10% das sess√µes semanais
            const frequenciaMaxima = Math.ceil(sessoesSemanais / 2); // M√°ximo 50% das sess√µes semanais
            
            let sessoesTotais = 0;
            
            materias.forEach(materia => {
                const percentual = materia.pontuacao / totalPontuacao;
                const sessoesCalculadas = Math.round(percentual * sessoesSemanais);
                
                // Aplicar limites m√≠nimo e m√°ximo
                materia.sessoes = Math.max(frequenciaMinima, Math.min(frequenciaMaxima, sessoesCalculadas));
                sessoesTotais += materia.sessoes;
            });
            
            // Se o total ficou muito diferente do planejado, ajustar proporcionalmente
            if (sessoesTotais > sessoesSemanais * 1.2) {
                const fatorAjuste = (sessoesSemanais * 1.1) / sessoesTotais;
                materias.forEach(materia => {
                    materia.sessoes = Math.max(frequenciaMinima, Math.round(materia.sessoes * fatorAjuste));
                });
            }
        }

        // Fun√ß√£o para gerar ciclo
        function gerarCiclo() {
            console.log('üîÑ Iniciando gera√ß√£o do ciclo...');
            
            if (materias.length === 0) {
                alert('‚ùå Adicione pelo menos uma mat√©ria antes de gerar o ciclo');
                return;
            }

            try {
                console.log(`üìö ${materias.length} mat√©rias encontradas`);
                calcularSessoesPorMateria();
                
                // Criar ciclo
                cicloAtual = [];
                
                materias.forEach(materia => {
                    const duracaoSessao = calcularDuracaoSessao(materia.peso, materia.dificuldade);
                    console.log(`‚ûï ${materia.nome}: ${materia.sessoes} sess√µes de ${duracaoSessao}min`);
                    
                    for (let i = 0; i < materia.sessoes; i++) {
                        cicloAtual.push({
                            materia: materia.nome,
                            dificuldade: materia.dificuldade,
                            peso: materia.peso,
                            duracao: duracaoSessao,
                            concluida: false
                        });
                    }
                });

                console.log(`üéØ Ciclo criado com ${cicloAtual.length} sess√µes`);

                // Embaralhar ciclo
                embaralharCiclo();
                console.log('üîÄ Ciclo embaralhado');
                
                sessaoAtualIndex = 0;
                sessoesConcluidas = 0;
                
                // Salvar dados
                salvarDados();
                console.log('üíæ Dados salvos');
                
                // Atualizar interface
                atualizarTabela();
                atualizarVisualizacaoCiclo();
                atualizarEstatisticas();
                
                console.log('‚úÖ Ciclo gerado com sucesso!');
                
                // Notifica√ß√£o de sucesso
                const primeiraSessao = cicloAtual[0];
                alert(`üéâ Ciclo gerado com sucesso!\n\nüìä Total: ${cicloAtual.length} sess√µes\n‚è±Ô∏è Tempo total: ${(cicloAtual.reduce((sum, s) => sum + s.duracao, 0) / 60).toFixed(1)}h\n\nüéØ Primeira sess√£o:\n${primeiraSessao.materia} (${primeiraSessao.duracao}min)`);
                
            } catch (error) {
                console.error('‚ùå Erro ao gerar ciclo:', error);
                alert(`‚ùå Erro ao gerar ciclo: ${error.message}\n\nTente novamente ou recarregue a p√°gina.`);
            }
        }

        // Fun√ß√£o para embaralhar ciclo respeitando a curva do esquecimento
        function embaralharCiclo() {
            const materiasPorNome = {};
            cicloAtual.forEach(sessao => {
                if (!materiasPorNome[sessao.materia]) {
                    materiasPorNome[sessao.materia] = [];
                }
                materiasPorNome[sessao.materia].push(sessao);
            });

            const resultado = [];
            const nomes = Object.keys(materiasPorNome);
            const intervalosIdeal = {}; // Intervalo ideal entre sess√µes de cada mat√©ria
            const ultimaPosicao = {}; // √öltima posi√ß√£o onde a mat√©ria apareceu
            
            // Calcular intervalo ideal para cada mat√©ria (baseado na curva do esquecimento)
            nomes.forEach(nome => {
                const sessoesDaMateria = materiasPorNome[nome].length;
                const intervaloIdeal = Math.max(3, Math.floor(cicloAtual.length / sessoesDaMateria));
                intervalosIdeal[nome] = Math.min(intervaloIdeal, 8); // M√°ximo 8 sess√µes de intervalo
                ultimaPosicao[nome] = -intervalosIdeal[nome]; // Iniciar permitindo imediato
            });

            // Distribuir sess√µes respeitando intervalos m√≠nimos
            for (let posicao = 0; posicao < cicloAtual.length; posicao++) {
                let melhorMateria = null;
                let melhorPrioridade = -1;
                
                // Encontrar a melhor mat√©ria para esta posi√ß√£o
                nomes.forEach(nome => {
                    const sessoesDaMateria = materiasPorNome[nome];
                    if (sessoesDaMateria.length === 0) return; // N√£o h√° mais sess√µes desta mat√©ria
                    
                    const intervaloAtual = posicao - ultimaPosicao[nome];
                    const intervaloMinimo = intervalosIdeal[nome];
                    
                    // Calcular prioridade baseada no intervalo e import√¢ncia
                    let prioridade = 0;
                    
                    if (intervaloAtual >= intervaloMinimo) {
                        // Mat√©ria pode ser colocada
                        const sessao = sessoesDaMateria[0];
                        const urgencia = Math.min(intervaloAtual / intervaloMinimo, 2); // Max 2x a urg√™ncia
                        prioridade = sessao.peso * sessao.dificuldade * urgencia;
                        
                        // Bonus para mat√©rias que est√£o h√° muito tempo sem aparecer
                        if (intervaloAtual > intervaloMinimo * 1.5) {
                            prioridade *= 1.5;
                        }
                    }
                    
                    if (prioridade > melhorPrioridade) {
                        melhorPrioridade = prioridade;
                        melhorMateria = nome;
                    }
                });
                
                // Se n√£o encontrou nenhuma mat√©ria adequada, pegar a que est√° h√° mais tempo
                if (!melhorMateria) {
                    let maiorIntervalo = -1;
                    nomes.forEach(nome => {
                        const sessoesDaMateria = materiasPorNome[nome];
                        if (sessoesDaMateria.length > 0) {
                            const intervaloAtual = posicao - ultimaPosicao[nome];
                            if (intervaloAtual > maiorIntervalo) {
                                maiorIntervalo = intervaloAtual;
                                melhorMateria = nome;
                            }
                        }
                    });
                }
                
                // Adicionar a sess√£o da mat√©ria escolhida
                if (melhorMateria && materiasPorNome[melhorMateria].length > 0) {
                    const sessao = materiasPorNome[melhorMateria].shift();
                    resultado.push(sessao);
                    ultimaPosicao[melhorMateria] = posicao;
                }
            }

            cicloAtual = resultado;
        }

        // Fun√ß√£o para atualizar tabela
        function atualizarTabela() {
            const tbody = document.querySelector('#tabelaMaterias tbody');
            tbody.innerHTML = '';

            materias.forEach((materia, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${materia.nome}</td>
                    <td>${materia.peso}</td>
                    <td>${materia.dificuldade}</td>
                    <td>${materia.pontuacao.toFixed(1)}</td>
                    <td>${materia.sessoes || 0}</td>
                    <td>
                        <button class="btn btn-danger" onclick="removerMateria(${index})" 
                                style="padding: 8px 12px; margin: 0; font-size: 12px;">‚ùå</button>
                    </td>
                `;
            });
        }

        // Fun√ß√£o para atualizar visualiza√ß√£o do ciclo
        function atualizarVisualizacaoCiclo() {
            const container = document.getElementById('cicloContainer');
            const info = document.getElementById('cicloInfo');
            const stats = document.getElementById('statsContainer');
            const progresso = document.getElementById('progressoContainer');
            const controles = document.getElementById('controlesContainer');
            const graficoContainer = document.getElementById('graficoContainer');


            const inicioSalvo = localStorage.getItem('cronometroInicio');
if (inicioSalvo) {
  const tempoPassado = Date.now() - parseInt(inicioSalvo);
  tempoDecorrido = tempoPassado; // atualiza o cron√¥metro com esse tempo
  atualizarVisualCronometro();   // exibe o tempo na tela
}


            
            if (cicloAtual.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; font-style: italic;">Adicione mat√©rias e clique em "Gerar Ciclo" para come√ßar</p>';
                if (info) info.style.display = 'none';
                if (stats) stats.style.display = 'none';
                if (progresso) progresso.style.display = 'none';
                if (controles) controles.style.display = 'none';
                if (graficoContainer) graficoContainer.style.display = 'none';
                return;
            }

            if (info) info.style.display = 'block';
            if (stats) stats.style.display = 'grid';
            if (progresso) progresso.style.display = 'block';
            if (controles) controles.style.display = 'block';
            if (graficoContainer) graficoContainer.style.display = 'block';

            let html = '';
            
            cicloAtual.forEach((sessao, index) => {
                const isAtual = index === sessaoAtualIndex;
                const isConcluida = sessao.concluida;
                
                let classe = '';
                if (isConcluida) classe = 'concluido';
                else if (isAtual) classe = 'atual';
                
                let icone = '';
                switch(sessao.dificuldade) {
                    case 5: icone = 'üî¥'; break; // Muito dif√≠cil - vermelho
                    case 4: icone = 'üü†'; break; // Dif√≠cil - laranja
                    case 3: icone = 'üü°'; break; // M√©dio - amarelo
                    case 2: icone = 'üü¢'; break; // F√°cil - verde
                    case 1: icone = 'üîµ'; break; // Muito f√°cil - azul
                }

                const status = isConcluida ? '‚úÖ' : (isAtual ? 'üëâ' : '‚è≥');
                
                html += `
                    <div class="ciclo-item ${classe}">
                        <div class="ciclo-info">
                            <h4>${status} ${icone} ${sessao.materia}</h4>
                            <small>Sess√£o ${index + 1} de ${cicloAtual.length} | Peso: ${sessao.peso} | Dificuldade: ${sessao.dificuldade}</small>
                        </div>
                        <div class="ciclo-tempo ${classe}">${sessao.duracao}min</div>
                    </div>
                `;
            });

            container.innerHTML = html;
            
            // Atualizar gr√°fico de pizza
            atualizarGraficoPizza();
            
            // Atualizar estat√≠sticas do cron√¥metro
            atualizarEstatisticasDia();
        }
function atualizarVisualCronometro() {
  const minutos = Math.floor(tempoDecorrido / 60000);
  const segundos = Math.floor((tempoDecorrido % 60000) / 1000);
  document.getElementById('cronometro').textContent =
    `${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;
}
        // Fun√ß√£o para atualizar estat√≠sticas
        function atualizarEstatisticas() {
            if (cicloAtual.length === 0) return;
            
            const totalSessoes = cicloAtual.length;
            const tempoTotal = cicloAtual.reduce((sum, s) => sum + s.duracao, 0);
            const tempoCompletoCiclo = (tempoTotal / 60).toFixed(1);
            
            // Calcular dias para completar baseado nas horas dispon√≠veis
            const horasSegSex = parseFloat(document.getElementById('horasSegSex').value) || 2;
            const horasSabado = parseFloat(document.getElementById('horasSabado').value) || 4;
            const horasDomingo = parseFloat(document.getElementById('horasDomingo').value) || 3;
            const horasPorDia = (horasSegSex * 5 + horasSabado + horasDomingo) / 7;
            const diasPrevisto = Math.ceil((tempoTotal / 60) / horasPorDia);
            
            document.getElementById('totalSessoes').textContent = totalSessoes;
            document.getElementById('tempoCompletoCiclo').textContent = tempoCompletoCiclo + 'h';
            document.getElementById('diasPrevisto').textContent = diasPrevisto;
            document.getElementById('sessaoAtual').textContent = sessaoAtualIndex + 1;
            
            // Atualizar barra de progresso
            const progressoFill = document.getElementById('progressoFill');
            if (progressoFill) {
                const percentual = (sessoesConcluidas / totalSessoes) * 100;
                progressoFill.style.width = percentual + '%';
            }
        }

        // Fun√ß√£o para marcar sess√£o como conclu√≠da
        function marcarConcluida() {
            if (cicloAtual.length === 0) {
                alert('Gere um ciclo primeiro!');
                return;
            }
            
            if (sessaoAtualIndex >= cicloAtual.length) {
                alert('Ciclo conclu√≠do! Ser√° reiniciado automaticamente.');
                reiniciarCiclo();
                return;
            }
            
            const sessaoAtual = cicloAtual[sessaoAtualIndex];
            
            if (sessaoAtual.concluida) {
                alert('Esta sess√£o j√° foi conclu√≠da!');
                return;
            }
            
            // Marcar como conclu√≠da
            sessaoAtual.concluida = true;
            sessoesConcluidas++;
            
            // Registrar no hist√≥rico
            registrarSessao(sessaoAtual.materia, sessaoAtual.duracao);
            
            // Avan√ßar para pr√≥xima sess√£o
            sessaoAtualIndex++;
            
            // Verificar se ciclo foi conclu√≠do
            if (sessaoAtualIndex >= cicloAtual.length) {
                estatisticasGerais.ciclosCompletos++;
                alert('üéâ Parab√©ns! Voc√™ completou um ciclo! O pr√≥ximo ciclo ser√° iniciado automaticamente.');
                reiniciarCiclo();
                return;
            }
            
            // Salvar e atualizar interface
            salvarDados();
            atualizarVisualizacaoCiclo();
            atualizarEstatisticas();
            
            // Mostrar pr√≥xima sess√£o
            const proximaSessao = cicloAtual[sessaoAtualIndex];
            alert(`‚úÖ Sess√£o conclu√≠da!\n\nüéØ Pr√≥xima sess√£o: ${proximaSessao.materia}\n‚è±Ô∏è Dura√ß√£o: ${proximaSessao.duracao} minutos`);
        }

        // Fun√ß√£o para reiniciar ciclo
        function reiniciarCiclo() {
            if (cicloAtual.length === 0) {
                alert('Gere um ciclo primeiro!');
                return;
            }
            
            // Resetar todas as sess√µes
            cicloAtual.forEach(sessao => {
                sessao.concluida = false;
            });
            
            // Embaralhar novamente para variar a ordem
            embaralharCiclo();
            
            sessaoAtualIndex = 0;
            sessoesConcluidas = 0;
            
            // Salvar e atualizar
            salvarDados();
            atualizarVisualizacaoCiclo();
            atualizarEstatisticas();
            
            const primeiraSessao = cicloAtual[0];
            alert(`üîÑ Ciclo reiniciado!\n\nüéØ Primeira sess√£o: ${primeiraSessao.materia}\n‚è±Ô∏è Dura√ß√£o: ${primeiraSessao.duracao} minutos`);
        }

        // Fun√ß√£o para imprimir ciclo
        function imprimirCiclo() {
            if (cicloAtual.length === 0) {
                alert('Gere um ciclo primeiro!');
                return;
            }
            
            let conteudo = `
                <html>
                <head>
                    <title>Checklist - Ciclo de Estudos</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .sessao { 
                            display: flex; 
                            justify-content: space-between; 
                            align-items: center;
                            padding: 10px; 
                            border-bottom: 1px solid #ddd; 
                            margin: 5px 0;
                        }
                        .checkbox { width: 20px; height: 20px; margin-right: 10px; }
                        .materia { font-weight: bold; flex: 1; }
                        .duracao { 
                            background: #4a5568; 
                            color: white; 
                            padding: 4px 8px; 
                            border-radius: 10px; 
                            font-size: 12px;
                        }
                        .info { color: #666; font-size: 12px; margin-left: 30px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>üéØ Checklist - Ciclo de Estudos</h1>
                        <p>Data: ${new Date().toLocaleDateString('pt-BR')}</p>
                        <p>Total de sess√µes: ${cicloAtual.length} | Tempo total: ${(cicloAtual.reduce((sum, s) => sum + s.duracao, 0) / 60).toFixed(1)}h</p>
                    </div>
            `;
            
            cicloAtual.forEach((sessao, index) => {
                let icone = '';
                switch(sessao.dificuldade) {
                    case 5: icone = 'üî¥'; break;
                    case 4: icone = 'üü†'; break;
                    case 3: icone = 'üü°'; break;
                    case 2: icone = 'üü¢'; break;
                    case 1: icone = 'üîµ'; break;
                }
                
                conteudo += `
                    <div class="sessao">
                        <input type="checkbox" class="checkbox">
                        <div class="materia">${index + 1}. ${icone} ${sessao.materia}</div>
                        <div class="duracao">${sessao.duracao}min</div>
                    </div>
                    <div class="info">Peso: ${sessao.peso} | Dificuldade: ${sessao.dificuldade}</div>
                `;
            });
            
            conteudo += `
                </body>
                </html>
            `;
            
            const janela = window.open('', '_blank');
            janela.document.write(conteudo);
            janela.document.close();
            janela.print();
        }

        // Fun√ß√£o para atualizar gr√°fico de pizza
        function atualizarGraficoPizza() {
            const canvas = document.getElementById('graficoPizza');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Calcular dados por mat√©ria
            const dadosPorMateria = {};
            cicloAtual.forEach(sessao => {
                if (!dadosPorMateria[sessao.materia]) {
                    dadosPorMateria[sessao.materia] = {
                        nome: sessao.materia,
                        sessoes: 0,
                        tempoTotal: 0,
                        dificuldade: sessao.dificuldade,
                        peso: sessao.peso,
                        concluidas: 0
                    };
                }
                dadosPorMateria[sessao.materia].sessoes++;
                dadosPorMateria[sessao.materia].tempoTotal += sessao.duracao;
                if (sessao.concluida) {
                    dadosPorMateria[sessao.materia].concluidas++;
                }
            });

            const materiasData = Object.values(dadosPorMateria);
            const totalSessoes = cicloAtual.length;
            
            // Ordenar mat√©rias por pontua√ß√£o (mais importantes primeiro)
            materiasData.sort((a, b) => {
                const pontuacaoA = Math.pow(a.peso, 1.5) * Math.pow(a.dificuldade, 1.2);
                const pontuacaoB = Math.pow(b.peso, 1.5) * Math.pow(b.dificuldade, 1.2);
                return pontuacaoB - pontuacaoA;
            });
            
            // Cores do gr√°fico - vermelho para muito importante, azul para menos importante
            const cores = [
                '#e53e3e', '#fd7d28', '#f6ad55', '#ecc94b', '#68d391', // Vermelho para amarelo
                '#4fd1c7', '#63b3ed', '#7c3aed', '#3182ce', '#2b6cb0', // Verde para azul
                '#2c5282', '#2a4365', '#1a202c', '#2d3748', '#4a5568'  // Azuis escuros
            ];

            // Desenhar gr√°fico de pizza
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 20;
            
            let startAngle = -Math.PI / 2;
            
            materiasData.forEach((materia, index) => {
                const percentage = materia.sessoes / totalSessoes;
                const sliceAngle = percentage * 2 * Math.PI;
                const endAngle = startAngle + sliceAngle;
                
                // Desenhar fatia
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.lineTo(centerX, centerY);
                ctx.fillStyle = cores[index % cores.length];
                ctx.fill();
                
                // Contorno
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Texto da porcentagem
                if (percentage > 0.05) {
                    const textAngle = startAngle + sliceAngle / 2;
                    const textX = centerX + Math.cos(textAngle) * (radius * 0.7);
                    const textY = centerY + Math.sin(textAngle) * (radius * 0.7);
                    
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(Math.round(percentage * 100) + '%', textX, textY);
                }
                
                startAngle = endAngle;
            });
            
            // Atualizar legenda e detalhes
            atualizarLegenda(materiasData, cores);
            atualizarDetalhes(materiasData);
        }

        // Fun√ß√£o para atualizar legenda
        function atualizarLegenda(materiasData, cores) {
            const legendaContainer = document.getElementById('legendaGrafico');
            if (!legendaContainer) return;
            
            let html = '<div style="display: flex; flex-direction: column; gap: 8px; text-align: left;">';
            
            materiasData.forEach((materia, index) => {
                const cor = cores[index % cores.length];
                html += `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; background: ${cor}; border-radius: 3px; flex-shrink: 0;"></div>
                        <span style="font-size: 14px; color: #2d3748;">${materia.nome}</span>
                    </div>
                `;
            });
            
            html += '</div>';
            legendaContainer.innerHTML = html;
        }

        // Fun√ß√£o para atualizar detalhes
        function atualizarDetalhes(materiasData) {
            const detalhesContainer = document.getElementById('listaDetalhes');
            if (!detalhesContainer) return;
            
            let html = '';
            
            materiasData.forEach(materia => {
                const percentualConcluido = (materia.concluidas / materia.sessoes) * 100;
                const tempoHoras = (materia.tempoTotal / 60).toFixed(1);
                
                let icone = '';
                switch(materia.dificuldade) {
                    case 5: icone = 'üî¥'; break; // Muito dif√≠cil - vermelho
                    case 4: icone = 'üü†'; break; // Dif√≠cil - laranja
                    case 3: icone = 'üü°'; break; // M√©dio - amarelo
                    case 2: icone = 'üü¢'; break; // F√°cil - verde
                    case 1: icone = 'üîµ'; break; // Muito f√°cil - azul
                }
                
                html += `
                    <div class="detalhe-item">
                        <div class="detalhe-header">
                            ${icone} ${materia.nome}
                        </div>
                        <div class="detalhe-info">
                            <strong>Sess√µes:</strong> ${materia.sessoes}<br>
                            <strong>Tempo:</strong> ${tempoHoras}h<br>
                            <strong>Peso:</strong> ${materia.peso} | <strong>Dificuldade:</strong> ${materia.dificuldade}<br>
                            <strong>Progresso:</strong> ${materia.concluidas}/${materia.sessoes} (${percentualConcluido.toFixed(0)}%)
                        </div>
                        <div class="progress-bar-small">
                            <div class="progress-fill" style="width: ${percentualConcluido}%"></div>
                        </div>
                    </div>
                `;
            });
            
            detalhesContainer.innerHTML = html;
        }

        // ===== FUN√á√ïES DO CRON√îMETRO =====
        
        function iniciarCronometro() {
            localStorage.setItem('cronometroInicio', Date.now());
localStorage.setItem('tempoDecorrido', tempoDecorrido);
localStorage.setItem('sessaoAtualIndex', sessaoAtualIndex);
            console.log('üéØ Tentando iniciar cron√¥metro...');
            const sessaoIndexSalvo = parseInt(localStorage.getItem('sessaoEmAndamento'));
const tempoRestanteSalvo = parseInt(localStorage.getItem('tempoRestanteSessao'));

if (sessaoIndexSalvo === sessaoAtualIndex && tempoRestanteSalvo > 0) {
  tempoDecorrido = (sessaoAtual.duracao - tempoRestanteSalvo) * 60000; // tempo j√° estudado em ms
  atualizarVisualCronometro();
}

            if (cicloAtual.length === 0) {
                alert('‚ùå Gere um ciclo primeiro!');
                console.log('‚ùå Nenhum ciclo encontrado');
                return;
            }
            
            if (sessaoAtualIndex >= cicloAtual.length) {
                alert('üéâ Ciclo conclu√≠do! Reinicie para continuar.');
                console.log('‚ùå √çndice da sess√£o fora do range');
                return;
            }
            
            // Buscar sess√£o atual
            sessaoAtual = cicloAtual[sessaoAtualIndex];
            if (!sessaoAtual) {
                alert('‚ùå Erro: Sess√£o atual n√£o encontrada');
                console.log('‚ùå Sess√£o atual √© undefined');
                return;
            }
            
            console.log(`üìö Iniciando sess√£o: ${sessaoAtual.materia} (${sessaoAtual.duracao}min)`);
            
            tempoMeta = sessaoAtual.duracao * 60; // Converter para segundos
            
            if (!cronometroAtivo) {
                // Iniciar nova sess√£o
                tempoInicio = Date.now();
                tempoDecorrido = 0;
                console.log('üÜï Nova sess√£o iniciada');
            } else if (cronometroPausado) {
                // Resumir sess√£o pausada
                tempoInicio = Date.now() - tempoDecorrido;
                console.log('‚ñ∂Ô∏è Sess√£o resumida');
            }
            
            cronometroAtivo = true;
            cronometroPausado = false;
            
            // Atualizar bot√µes
            const btnPlay = document.getElementById('btnPlay');
            const btnPause = document.getElementById('btnPause');
            const btnStop = document.getElementById('btnStop');
            const btnComplete = document.getElementById('btnComplete');
            
            if (btnPlay) btnPlay.disabled = true;
            if (btnPause) btnPause.disabled = false;
            if (btnStop) btnStop.disabled = false;
            if (btnComplete) btnComplete.disabled = false;
            
            // Atualizar displays
            const cronometroSessao = document.getElementById('cronometroSessao');
            const cronometroMeta = document.getElementById('cronometroMeta');
            
            if (cronometroSessao) {
                cronometroSessao.textContent = `üìö Estudando: ${sessaoAtual.materia}`;
            }
            if (cronometroMeta) {
                cronometroMeta.textContent = `Meta: ${formatarTempoMM(tempoMeta)}`;
            }
            
            // Adicionar efeito visual
            const container = document.getElementById('cronometroContainer');
            if (container) {
                container.classList.add('ativo');
            }
            
            // Limpar intervalo anterior se existir
            if (intervaloCronometro) {
                clearInterval(intervaloCronometro);
            }
            
            // Iniciar novo intervalo
            intervaloCronometro = setInterval(atualizarCronometro, 1000);
            
            console.log(`‚úÖ Cron√¥metro iniciado! Meta: ${tempoMeta}s`);
            
            // Primeira atualiza√ß√£o imediata
            atualizarCronometro();
        }
        
        function pausarCronometro() {
            if (!cronometroAtivo) return;
            
            cronometroPausado = true;
            clearInterval(intervaloCronometro);
            
            // Atualizar interface
            document.getElementById('btnPlay').disabled = false;
            document.getElementById('btnPause').disabled = true;
            document.getElementById('cronometroContainer').classList.remove('ativo');
            
            console.log('‚è∏Ô∏è Cron√¥metro pausado');
        }
        
        function pararCronometro() {
            if (!cronometroAtivo && !cronometroPausado) return;
            localStorage.removeItem('cronometroInicio');
const sessaoAtual = cicloAtual[sessaoAtualIndex];
if (sessaoAtual) {
  localStorage.setItem('tempoRestanteSessao', sessaoAtual.duracao - Math.floor(tempoDecorrido / 60000)); // em minutos
  localStorage.setItem('sessaoEmAndamento', sessaoAtualIndex);
}

            // Parar completamente
            cronometroAtivo = false;
            cronometroPausado = false;
            clearInterval(intervaloCronometro);
            
            // Resetar tempos
            tempoDecorrido = 0;
            tempoMeta = 0;
            sessaoAtual = null;
            
            // Atualizar interface
            document.getElementById('btnPlay').disabled = false;
            document.getElementById('btnPause').disabled = true;
            document.getElementById('btnStop').disabled = true;
            document.getElementById('btnComplete').disabled = true;
            
            document.getElementById('cronometroTempo').textContent = '00:00';
            document.getElementById('cronometroSessao').textContent = 'Pr√≥xima sess√£o: Clique em Iniciar';
            document.getElementById('cronometroMeta').textContent = 'Meta: --:--';
            document.getElementById('cronometroFill').style.width = '0%';
            document.getElementById('cronometroContainer').classList.remove('ativo');
            
            console.log('‚èπÔ∏è Cron√¥metro parado');
        }
        
        function completarSessao() {
            if (!cronometroAtivo && !cronometroPausado) return;
            localStorage.removeItem('cronometroInicio');

            const tempoEstudado = Math.ceil(tempoDecorrido / 60); // Converter para minutos
            localStorage.removeItem('tempoRestanteSessao');
localStorage.removeItem('sessaoEmAndamento');


            localStorage.removeItem('tempoDecorrido');
localStorage.removeItem('sessaoAtualIndex');

            // Parar cron√¥metro
            pararCronometro();
            
            // Registrar sess√£o no hist√≥rico
            registrarSessao(sessaoAtual.materia, tempoEstudado);
            
            // Marcar como conclu√≠da
            marcarConcluida();
            
            // Atualizar estat√≠sticas do dia
            atualizarEstatisticasDia();
            
            console.log(`‚úÖ Sess√£o completada: ${sessaoAtual.materia} (${tempoEstudado}min)`);

            pararCronometro(); // garante que o cron√¥metro pare

  const tempoRealMinutos = Math.floor(tempoDecorrido / 60000); // converte o tempo decorrido em minutos

  // Valida se estudou pelo menos 5 min para registrar
  if (tempoRealMinutos >= 5) {
    const sessao = cicloAtual[sessaoAtualIndex];
    if (sessao) {
      registrarSessao(sessao.materia, tempoRealMinutos); // salva no hist√≥rico
      sessoesConcluidas++; // atualiza total de sess√µes
      atualizarEstatisticasDia(); // atualiza estat√≠sticas visuais (como "Sess√µes Hoje")
      salvarDados(); // salva no navegador
    }
  }
  // Avan√ßa para pr√≥xima sess√£o
  sessaoAtualIndex++;
  atualizarVisualizacaoCiclo();
        }
        
        function atualizarCronometro() {
            if (!cronometroAtivo) {
                console.log('‚ö†Ô∏è Cron√¥metro n√£o est√° ativo');
                return;
            }
            
            tempoDecorrido = Date.now() - tempoInicio;
            const segundos = Math.floor(tempoDecorrido / 1000);
            
            // Debug a cada 10 segundos
            if (segundos % 10 === 0 && segundos > 0) {
                console.log(`‚è∞ Cron√¥metro: ${formatarTempoMM(segundos)} / ${formatarTempoMM(tempoMeta)}`);
            }
            
            // Atualizar display do tempo
            const cronometroTempo = document.getElementById('cronometroTempo');
            if (cronometroTempo) {
                cronometroTempo.textContent = formatarTempoMM(segundos);
            }
            
            // Atualizar barra de progresso
            if (tempoMeta > 0) {
                const progresso = Math.min((segundos / tempoMeta) * 100, 100);
                const fill = document.getElementById('cronometroFill');
                
                if (fill) {
                    fill.style.width = progresso + '%';
                    
                    // Mudan√ßa de cor conforme progresso
                    if (progresso >= 100) {
                        fill.style.background = 'linear-gradient(90deg, #ef4444, #dc2626)';
                    } else if (progresso >= 90) {
                        fill.style.background = 'linear-gradient(90deg, #f59e0b, #d97706)';
                    } else {
                        fill.style.background = 'linear-gradient(90deg, #4ade80, #22c55e)';
                    }
                }
            }
            
            // Notifica√ß√£o quando atingir a meta
            if (tempoMeta > 0 && segundos >= tempoMeta && segundos <= tempoMeta + 2) {
                console.log('üéØ Meta de tempo atingida!');
                
                // Vibra√ß√£o se dispon√≠vel
                if (navigator.vibrate) {
                    navigator.vibrate([200, 100, 200]);
                }
                
                // Efeito visual
                const container = document.getElementById('cronometroContainer');
                if (container) {
                    container.style.animation = 'pulso 0.5s ease-in-out 3';
                    setTimeout(() => {
                        container.style.animation = '';
                    }, 1500);
                }
                
                // Notifica√ß√£o sonora (se permitida)
                try {
                    const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+Dwtmwhh');
                    audio.play().catch(() => {}); // Ignorar erro se n√£o conseguir tocar
                } catch (e) {}
            }
        }
        
        function formatarTempoMM(segundos) {
            const mins = Math.floor(segundos / 60);
            const secs = segundos % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
             
            

        }
        
        function atualizarEstatisticasDia() {
            const hoje = new Date().toDateString();
            
            // Tempo estudado hoje
            const sessoesHoje = historicoEstudos.filter(sessao => {
                const dataSessao = new Date(sessao.data).toDateString();
                return dataSessao === hoje;

                // Somar tempo estudado hoje
  const historico = recuperarHistoricoHoje(); // deve retornar array de sess√µes do dia
  const minutosHoje = historico.reduce((total, sessao) => total + sessao.duracao, 0);

  // Converter pra horas e minutos
  const horas = Math.floor(minutosHoje / 60);
  const minutos = minutosHoje % 60;

  // Atualizar texto na interface
  const texto = `Voc√™ estudou hoje: ${horas}h${minutos.toString().padStart(2, '0')}min`;
  document.getElementById('tempoTotalHoje').textContent = texto;

let frase = '';

if (minutosHoje > 0) {
  if (minutosHoje < 30) {
    frase = 'üå± Todo come√ßo conta. Voc√™ est√° no caminho certo!';
  } else if (minutosHoje < 60) {
    frase = 'üî• Foco ativado! Continue assim.';
  } else if (minutosHoje < 120) {
    frase = 'üöÄ Voc√™ t√° voando! D√° pra conquistar muito hoje.';
  } else if (minutosHoje < 180) {
    frase = 'üíé Produtividade de elite! Orgulho de voc√™!';
  } else {
    frase = 'üß†üëë Voc√™ √© uma m√°quina dos estudos!';
  }
}

document.getElementById('fraseMotivacional').textContent = frase;


                
            });
            
            const tempoHoje = sessoesHoje.reduce((total, sessao) => total + sessao.duracao, 0);
            const quantidadeHoje = sessoesHoje.length;
            
            // Streak de dias
            let streak = 0;
            const datasUnicas = [...new Set(historicoEstudos.map(s => new Date(s.data).toDateString()))];
            datasUnicas.sort((a, b) => new Date(b) - new Date(a));
            
            for (let i = 0; i < datasUnicas.length; i++) {
                const data = new Date(datasUnicas[i]);
                const dataEsperada = new Date();
                dataEsperada.setDate(dataEsperada.getDate() - i);
                
                if (data.toDateString() === dataEsperada.toDateString()) {
                    streak++;
                } else {
                    break;
                }
            }
            
            // Atualizar interface
            document.getElementById('tempoEstudado').textContent = `${tempoHoje}min`;
            document.getElementById('sessoesHoje').textContent = quantidadeHoje;
            document.getElementById('streakDias').textContent = streak;
        }
    </script>
</body>
</html>
