<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cron√¥metro de Estudos Avan√ßado - by @tecaestt</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #2d3748;
            border-bottom: 3px solid #4a5568;
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-field {
            display: flex;
            flex-direction: column;
        }
        
        .input-field label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #34495e;
        }
        
        .input-field input, .input-field select {
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .input-field input:focus, .input-field select:focus {
            outline: none;
            border-color: #4a5568;
        }
        
        .btn {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 85, 104, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #38a169, #2f855a);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #dd6b20, #c05621);
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }
        
        th {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .resultado {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #38a169;
        }
        
        .resultado h3 {
            color: #38a169;
            margin-top: 0;
        }
        
        .ciclo-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #4a5568;
        }
        
        .ciclo-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #4a5568;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .ciclo-item.atual {
            border-left-color: #38a169;
            background: #f0fff4;
        }
        
        .ciclo-item.concluido {
            border-left-color: #a0aec0;
            background: #f7fafc;
            opacity: 0.7;
        }
        
        .ciclo-info {
            flex: 1;
        }
        
        .ciclo-info h4 {
            margin: 0 0 5px 0;
            color: #2d3748;
        }
        
        .ciclo-info small {
            color: #6c757d;
        }
        
        .ciclo-tempo {
            background: #4a5568;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .ciclo-tempo.atual {
            background: #38a169;
        }
        
        .ciclo-tempo.concluido {
            background: #a0aec0;
        }
        
        .controles {
            text-align: center;
            margin: 20px 0;
        }
        
        .progresso-ciclo {
            background: #ecf0f1;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progresso-fill {
            background: linear-gradient(135deg, #38a169, #2f855a);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #4a5568;
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            color: #2d3748;
            font-size: 1.8em;
        }
        
        .stat-card p {
            margin: 0;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #856404;
            border-left: 4px solid #dd6b20;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            color: #0c5460;
            border-left: 4px solid #4a5568;
        }

        .btn-group-mobile {
            display: flex;
            flex-direction: row;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-group-mobile .btn {
            margin: 0;
            flex: 1;
            min-width: 150px;
        }

        /* Estilos dos Cron√¥metros */
        .cronometros-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .cronometro-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border-left: 5px solid #4a5568;
            transition: all 0.3s ease;
        }

        .cronometro-card.meta {
            border-left-color: #e53e3e;
        }

        .cronometro-card.livre {
            border-left-color: #3b82f6;
        }

        .cronometro-card.pomodoro {
            border-left-color: #f59e0b;
        }

        .cronometro-card.ativo {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .cronometro-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .cronometro-titulo {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3748;
        }

        .cronometro-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .cronometro-tempo {
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 5px;
            font-family: 'Monaco', 'Menlo', monospace;
            color: #2d3748;
        }

        .cronometro-info {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .cronometro-meta {
            font-size: 0.8em;
            color: #6c757d;
        }

        .cronometro-controles {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .btn-cronometro {
            background: #f8f9fa;
            color: #2d3748;
            border: 2px solid #e2e8f0;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 70px;
        }

        .btn-cronometro:hover:not(:disabled) {
            background: #e2e8f0;
            transform: translateY(-1px);
        }

        .btn-cronometro:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-play {
            background: #38a169 !important;
            color: white !important;
            border-color: #38a169 !important;
        }

        .btn-pause {
            background: #dd6b20 !important;
            color: white !important;
            border-color: #dd6b20 !important;
        }

        .btn-stop {
            background: #e53e3e !important;
            color: white !important;
            border-color: #e53e3e !important;
        }

        .btn-complete {
            background: #8b5cf6 !important;
            color: white !important;
            border-color: #8b5cf6 !important;
        }

        .cronometro-config {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
            justify-content: center;
        }

        .cronometro-config select,
        .cronometro-config input {
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 12px;
            max-width: 120px;
        }

        .pomodoro-info {
            text-align: center;
            margin-bottom: 15px;
        }

        .pomodoro-ciclo {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .pomodoro-fase {
            font-size: 0.8em;
            color: #6c757d;
        }

        .pomodoro-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            gap: 10px;
        }

        .pomodoro-stat {
            text-align: center;
            background: #f8f9fa;
            padding: 8px;
            border-radius: 8px;
            flex: 1;
        }

        .pomodoro-stat-valor {
            font-size: 1.1em;
            font-weight: 600;
            color: #2d3748;
        }

        .pomodoro-stat-label {
            font-size: 0.7em;
            color: #6c757d;
        }

        /* Resumo do Dia */
        .resumo-dia {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .resumo-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #4a5568;
        }

        .resumo-valor {
            font-size: 1.5em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .resumo-label {
            font-size: 0.8em;
            color: #6c757d;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 15px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .btn-group-mobile {
                flex-direction: column;
            }
            
            .btn-group-mobile .btn {
                width: 100%;
                margin: 5px 0;
            }
            
            .cronometros-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .cronometro-tempo {
                font-size: 2em;
            }
            
            .cronometro-controles {
                gap: 5px;
            }
            
            .btn-cronometro {
                padding: 6px 8px;
                font-size: 11px;
                min-width: 60px;
            }
            
            .resumo-dia {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚è±Ô∏è Cron√¥metro de Estudos Avan√ßado</h1>
            <p>Sistema completo de cronometragem e gest√£o de estudos</p>
        </div>
        
        <div class="content">
            <!-- Configura√ß√£o B√°sica -->
            <div class="section">
                <h2>‚öôÔ∏è Configura√ß√£o B√°sica</h2>
                <div class="input-group">
                    <div class="input-field">
                        <label>Horas dispon√≠veis (Segunda a Sexta)</label>
                        <input type="number" id="horasSegSex" value="2" min="0.5" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Horas dispon√≠veis (S√°bado)</label>
                        <input type="number" id="horasSabado" value="4" min="0" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Horas dispon√≠veis (Domingo)</label>
                        <input type="number" id="horasDomingo" value="3" min="0" max="12" step="0.5" onchange="calcularSessoesPorDia()">
                    </div>
                    <div class="input-field">
                        <label>Dura√ß√£o base da sess√£o (minutos)</label>
                        <select id="duracaoSessao" onchange="calcularSessoesPorDia()">
                            <option value="25">25 min (Pomodoro)</option>
                            <option value="30">30 min (Iniciante)</option>
                            <option value="45" selected>45 min (Intermedi√°rio)</option>
                            <option value="60">60 min (Avan√ßado)</option>
                            <option value="90">90 min (Expert)</option>
                        </select>
                    </div>
                </div>
                <div class="resultado">
                    <h3>üìä Horas semanais: <span id="horasSemanais">17.0</span>h | Sess√µes: <span id="sessoesSemanais">22</span></h3>
                    <p>üí° Tempo produtivo estimado: <span id="tempoLiquido">16h30</span></p>
                </div>
            </div>

            <!-- Cadastro de Mat√©rias -->
            <div class="section">
                <h2>üìö Cadastro de Mat√©rias</h2>
                <div class="input-group">
                    <div class="input-field">
                        <label>Nome da Mat√©ria</label>
                        <select id="nomeMateria" onchange="toggleMateriaCustomizada()">
                            <option value="">Selecione uma mat√©ria</option>
                            <option value="Administra√ß√£o Geral">Administra√ß√£o Geral</option>
                            <option value="Administra√ß√£o P√∫blica">Administra√ß√£o P√∫blica</option>
                            <option value="Direito Administrativo">Direito Administrativo</option>
                            <option value="Direito Civil">Direito Civil</option>
                            <option value="Direito Constitucional">Direito Constitucional</option>
                            <option value="Direito Penal">Direito Penal</option>
                            <option value="Direito Tribut√°rio">Direito Tribut√°rio</option>
                            <option value="L√≠ngua Portuguesa">L√≠ngua Portuguesa</option>
                            <option value="Racioc√≠nio L√≥gico-Matem√°tico">Racioc√≠nio L√≥gico-Matem√°tico</option>
                            <option value="Inform√°tica">Inform√°tica</option>
                            <option value="Contabilidade">Contabilidade</option>
                            <option value="Economia">Economia</option>
                            <option value="Estat√≠stica">Estat√≠stica</option>
                            <option value="‚úèÔ∏è Digitar outra mat√©ria">‚úèÔ∏è Digitar outra mat√©ria</option>
                        </select>
                        <input type="text" id="materiaCustomizada" placeholder="Digite o nome da mat√©ria" style="display: none; margin-top: 10px;">
                    </div>
                    <div class="input-field">
                        <label>Import√¢ncia no Edital (1-10)</label>
                        <input type="number" id="importanciaMateria" min="1" max="10" value="5">
                        <small style="color: #6c757d;">1=Baixa, 5=M√©dia, 10=Muito Alta</small>
                    </div>
                    <div class="input-field">
                        <label>Sua Dificuldade (1-5)</label>
                        <select id="dificuldadeMateria">
                            <option value="1">1 - Muito F√°cil</option>
                            <option value="2">2 - F√°cil</option>
                            <option value="3" selected>3 - M√©dio</option>
                            <option value="4">4 - Dif√≠cil</option>
                            <option value="5">5 - Muito Dif√≠cil</option>
                        </select>
                    </div>
                    <div class="input-field">
                        <label>Extens√£o da Mat√©ria</label>
                        <select id="extensaoMateria">
                            <option value="1">Pequenina</option>
                            <option value="2">Pequena</option>
                            <option value="3" selected>M√©dia</option>
                            <option value="4">Grande</option>
                            <option value="5">Muito Grande</option>
                            <option value="6">Extensa</option>
                        </select>
                    </div>
                </div>
                <div class="btn-group-mobile">
                    <button class="btn" onclick="adicionarMateria()">‚ûï Adicionar Mat√©ria</button>
                    <button class="btn btn-success" onclick="gerarCiclo()">üîÑ Gerar Ciclo</button>
                    <button class="btn btn-danger" onclick="limparTudo()">üóëÔ∏è Limpar Tudo</button>
                </div>
            </div>

            <!-- Tabela de Mat√©rias -->
            <div class="section">
                <h2>üìã Mat√©rias Cadastradas</h2>
                <div class="table-container">
                    <table id="tabelaMaterias">
                        <thead>
                            <tr>
                                <th>Mat√©ria</th>
                                <th>Import√¢ncia</th>
                                <th>Dificuldade</th>
                                <th>Extens√£o</th>
                                <th>Pontua√ß√£o Final</th>
                                <th>Tempo por Sess√£o</th>
                                <th>Sess√µes no Ciclo</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- Cron√¥metros de Estudo -->
            <div class="section">
                <h2>‚è±Ô∏è Cron√¥metros de Estudo</h2>
                <div class="info">
                    <strong>üí° Tr√™s tipos de cron√¥metros:</strong><br>
                    ‚Ä¢ <strong>Meta de Estudos:</strong> Cron√¥metro vinculado ao ciclo de estudos com tempo espec√≠fico por mat√©ria<br>
                    ‚Ä¢ <strong>Tempo Livre:</strong> Cron√¥metro independente para estudar qualquer mat√©ria por tempo personalizado<br>
                    ‚Ä¢ <strong>Pomodoro:</strong> T√©cnica de 25min de estudo + 5min de pausa (ciclos autom√°ticos)
                </div>
                
                <div class="cronometros-container">
                    <!-- Cron√¥metro Meta de Estudos -->
                    <div class="cronometro-card meta" id="cronometroMeta">
                        <div class="cronometro-header">
                            <span>üéØ</span>
                            <span class="cronometro-titulo">Meta de Estudos</span>
                        </div>
                        <div class="cronometro-display">
                            <div class="cronometro-tempo" id="tempoMeta">00:00</div>
                            <div class="cronometro-info" id="infoMeta">Pr√≥xima sess√£o: Gere um ciclo primeiro</div>
                            <div class="cronometro-meta" id="metaMeta">Meta: --:--</div>
                        </div>
                        <div class="cronometro-controles">
                            <button class="btn-cronometro btn-play" id="btnPlayMeta" onclick="iniciarCronometroMeta()">‚ñ∂Ô∏è Iniciar</button>
                            <button class="btn-cronometro btn-pause" id="btnPauseMeta" onclick="pausarCronometroMeta()" disabled>‚è∏Ô∏è Pausar</button>
                            <button class="btn-cronometro btn-stop" id="btnStopMeta" onclick="pararCronometroMeta()" disabled>‚èπÔ∏è Parar</button>
                            <button class="btn-cronometro btn-complete" id="btnCompleteMeta" onclick="completarSessaoMeta()" disabled>‚úÖ Concluir</button>
                        </div>
                    </div>

                    <!-- Cron√¥metro Tempo Livre -->
                    <div class="cronometro-card livre" id="cronometroLivre">
                        <div class="cronometro-header">
                            <span>üÜì</span>
                            <span class="cronometro-titulo">Tempo Livre</span>
                        </div>
                        <div class="cronometro-display">
                            <div class="cronometro-tempo" id="tempoLivre">00:00</div>
                            <div class="cronometro-config">
                                <select id="materiaLivre">
                                    <option value="Outra Mat√©ria">Outra Mat√©ria</option>
                                </select>
                                <input type="number" id="tempoLivreInput" placeholder="Tempo (min)" min="5" max="180" value="30">
                            </div>
                            <div class="cronometro-meta" id="metaLivre">Meta: 30:00</div>
                        </div>
                        <div class="cronometro-controles">
                            <button class="btn-cronometro btn-play" id="btnPlayLivre" onclick="iniciarCronometroLivre()">‚ñ∂Ô∏è Iniciar</button>
                            <button class="btn-cronometro btn-pause" id="btnPauseLivre" onclick="pausarCronometroLivre()" disabled>‚è∏Ô∏è Pausar</button>
                            <button class="btn-cronometro btn-stop" id="btnStopLivre" onclick="pararCronometroLivre()" disabled>‚èπÔ∏è Parar</button>
                            <button class="btn-cronometro btn-complete" id="btnCompleteLivre" onclick="completarSessaoLivre()" disabled>‚úÖ Concluir</button>
                        </div>
                    </div>

                    <!-- Cron√¥metro Pomodoro -->
                    <div class="cronometro-card pomodoro" id="cronometroPomodoro">
                        <div class="cronometro-header">
                            <span>üçÖ</span>
                            <span class="cronometro-titulo">Pomodoro</span>
                        </div>
                        <div class="cronometro-display">
                            <div class="cronometro-tempo" id="tempoPomodoro">25:00</div>
                            <div class="cronometro-config">
                                <select id="materiaPomodoro">
                                    <option value="Outra Mat√©ria">Outra Mat√©ria</option>
                                </select>
                                <input type="number" id="tempoEstudoPomodoro" placeholder="Estudo (min)" min="15" max="60" value="25">
                                <input type="number" id="tempoPausaPomodoro" placeholder="Pausa (min)" min="5" max="30" value="5">
                            </div>
                            <div class="pomodoro-info">
                                <div class="pomodoro-ciclo" id="cicloPomodoro">Ciclo: 1 | Fase: Estudo</div>
                                <div class="pomodoro-fase" id="fasePomodoro">25min estudo ‚Üí 5min pausa</div>
                            </div>
                        </div>
                        <div class="cronometro-controles">
                            <button class="btn-cronometro btn-play" id="btnPlayPomodoro" onclick="iniciarCronometroPomodoro()">‚ñ∂Ô∏è Iniciar</button>
                            <button class="btn-cronometro btn-pause" id="btnPausePomodoro" onclick="pausarCronometroPomodoro()" disabled>‚è∏Ô∏è Pausar</button>
                            <button class="btn-cronometro btn-stop" id="btnStopPomodoro" onclick="pararCronometroPomodoro()" disabled>‚èπÔ∏è Parar</button>
                            <button class="btn-cronometro" id="btnPularPomodoro" onclick="pularFasePomodoro()" disabled>‚è≠Ô∏è Pular Fase</button>
                        </div>
                        <div class="pomodoro-stats">
                            <div class="pomodoro-stat">
                                <div class="pomodoro-stat-valor" id="pomodorosHoje">0</div>
                                <div class="pomodoro-stat-label">Pomodoros Hoje</div>
                            </div>
                            <div class="pomodoro-stat">
                                <div class="pomodoro-stat-valor" id="tempoFocoHoje">0min</div>
                                <div class="pomodoro-stat-label">Tempo Foco</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resumo do Dia -->
                <div class="resumo-dia">
                    <div class="resumo-card">
                        <div class="resumo-valor" id="tempoTotalHoje">0h00min</div>
                        <div class="resumo-label">Tempo Total Estudado Hoje</div>
                    </div>
                    <div class="resumo-card">
                        <div class="resumo-valor" id="sessoesHoje">0</div>
                        <div class="resumo-label">Sess√µes Conclu√≠das Hoje</div>
                    </div>
                    <div class="resumo-card">
                        <div class="resumo-valor" id="materiasHoje">0</div>
                        <div class="resumo-label">Mat√©rias Diferentes</div>
                    </div>
                    <div class="resumo-card">
                        <div class="resumo-valor" id="metaDiaria">0%</div>
                        <div class="resumo-label">Meta Di√°ria</div>
                    </div>
                </div>
            </div>

            <!-- Seu Ciclo de Estudos -->
            <div class="section">
                <h2>üîÑ Seu Ciclo de Estudos</h2>
                <div class="ciclo-container" id="cicloContainer">
                    <p style="text-align: center; color: #6c757d; font-style: italic;">
                        Adicione mat√©rias e clique em "Gerar Ciclo" para come√ßar
                    </p>
                </div>
            </div>

            <!-- Mat√©rias Estudadas Hoje -->
            <div class="section" id="materiasHojeSection" style="display: none;">
                <h2>üìÖ Distribui√ß√£o do Tempo por Mat√©ria</h2>
                <div id="materiasHojeEstatisticas" class="stats"></div>
                <div class="ciclo-container">
                    <h3 style="text-align: center; color: #2d3748; margin-bottom: 20px;">üìä Tempo por Mat√©ria Hoje</h3>
                    <div id="materiasHojeGrafico" style="max-height: 400px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- Hist√≥rico de Estudos -->
            <div class="section" id="historicoSection" style="display: none;">
                <h2>üìà Hist√≥rico de Estudos</h2>
                <div id="historicoEstatisticas" class="stats"></div>
                <div class="ciclo-container">
                    <h3 style="text-align: center; color: #2d3748; margin-bottom: 20px;">üìÖ √öltimas Sess√µes</h3>
                    <div id="historicoLista" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- Instru√ß√µes de Como Usar -->
            <div class="section">
                <h2>üìñ Como Usar</h2>
                <div class="warning">
                    <strong>üéØ Novidades desta vers√£o:</strong><br>
                    ‚Ä¢ <strong>Tr√™s cron√¥metros independentes:</strong> Meta de estudos, tempo livre e Pomodoro<br>
                    ‚Ä¢ <strong>Sistema de pesos melhorado:</strong> Import√¢ncia + Dificuldade + Extens√£o da mat√©ria<br>
                    ‚Ä¢ <strong>Tempo sempre contabilizado:</strong> Independente de concluir a meta ou n√£o<br>
                    ‚Ä¢ <strong>Tempos personalizados:</strong> Cada mat√©ria tem dura√ß√£o espec√≠fica baseada na import√¢ncia<br>
                    ‚Ä¢ <strong>Interface reorganizada:</strong> Resumo do dia e hist√≥rico em posi√ß√µes mais intuitivas
                </div>
                
                <div class="info">
                    <strong>üìù Passos para usar:</strong><br>
                    1. Configure suas horas dispon√≠veis e dura√ß√£o base das sess√µes<br>
                    2. Adicione mat√©rias com import√¢ncia, dificuldade e extens√£o<br>
                    3. Gere o ciclo para ver a distribui√ß√£o inteligente de tempo<br>
                    4. Use o cron√¥metro "Meta de Estudos" para seguir o ciclo automaticamente<br>
                    5. Use "Tempo Livre" para estudos extras ou revis√µes<br>
                    6. Use "Pomodoro" para sess√µes focadas com pausas autom√°ticas
                </div>
                
                <div class="info">
                    <strong>‚è±Ô∏è Sobre os tempos das sess√µes:</strong><br>
                    ‚Ä¢ <strong>F√≥rmula:</strong> Tempo Base √ó (1 + Import√¢ncia/20) √ó (1 + Dificuldade/10) √ó (1 + Extens√£o/15)<br>
                    ‚Ä¢ <strong>Exemplo:</strong> Base 45min, Import√¢ncia 8, Dificuldade 4, Extens√£o 5 = 45 √ó 1.4 √ó 1.4 √ó 1.33 = 117min<br>
                    ‚Ä¢ <strong>Limites:</strong> M√≠nimo 15min, m√°ximo 120min por sess√£o<br>
                    ‚Ä¢ <strong>Arredondamento:</strong> M√∫ltiplos de 5 minutos para facilitar
                </div>
                
                <div class="warning">
                    <strong>üíæ Salvamento autom√°tico:</strong><br>
                    Todos os tempos estudados s√£o salvos automaticamente, mesmo se voc√™ parar o cron√¥metro antes da meta. Seus dados ficam seguros no navegador e voc√™ pode exportar para backup.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let materias = [];
        let cicloAtual = [];
        let sessaoAtualIndex = 0;
        let historicoEstudos = [];
        let estatisticasGerais = {
            totalSessoes: 0,
            totalTempo: 0,
            tempoTotalPorMateria: {}
        };

        // Vari√°veis dos cron√¥metros
        let cronometros = {
            meta: {
                ativo: false,
                pausado: false,
                tempoInicio: 0,
                tempoDecorrido: 0,
                tempoMeta: 0,
                intervalo: null,
                sessaoAtual: null
            },
            livre: {
                ativo: false,
                pausado: false,
                tempoInicio: 0,
                tempoDecorrido: 0,
                tempoMeta: 0,
                intervalo: null,
                materiaAtual: null
            },
            pomodoro: {
                ativo: false,
                pausado: false,
                tempoInicio: 0,
                tempoDecorrido: 0,
                tempoMeta: 0,
                intervalo: null,
                cicloAtual: 1,
                faseAtual: 'estudo', // 'estudo' ou 'pausa'
                pomodorosHoje: 0,
                tempoFocoHoje: 0,
                materiaAtual: null,
                tempoEstudo: 25,
                tempoPausa: 5,
                contadorRegressivo: true
            }
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            calcularSessoesPorDia();
            atualizarSelectsMaterias();
            atualizarEstatisticasDia();
            atualizarInputsPomodoro();
        });

        // Fun√ß√£o para mostrar/esconder campo de mat√©ria customizada
        function toggleMateriaCustomizada() {
            const select = document.getElementById('nomeMateria');
            const input = document.getElementById('materiaCustomizada');
            
            if (select.value === '‚úèÔ∏è Digitar outra mat√©ria') {
                input.style.display = 'block';
                input.focus();
            } else {
                input.style.display = 'none';
                input.value = '';
            }
        }

        // Fun√ß√£o para calcular dura√ß√£o da sess√£o baseada nos crit√©rios
        function calcularDuracaoSessao(importancia, dificuldade, extensao) {
            const duracaoBase = parseInt(document.getElementById('duracaoSessao').value) || 45;
            
            // Considerar tempo dispon√≠vel no dia
            const horasSegSex = parseFloat(document.getElementById('horasSegSex').value) || 2;
            const horasSabado = parseFloat(document.getElementById('horasSabado').value) || 4;
            const horasDomingo = parseFloat(document.getElementById('horasDomingo').value) || 3;
            const mediaHorasDia = (horasSegSex * 5 + horasSabado + horasDomingo) / 7;
            const tempoMaximoPorSessao = Math.min(120, (mediaHorasDia * 60) / 2); // M√°ximo metade do tempo dispon√≠vel
            
            // Fator de import√¢ncia (1-10): mat√©rias mais importantes precisam de mais tempo
            const fatorImportancia = 0.8 + (importancia / 20) * 0.8; // Varia de 0.8 a 1.6
            
            // Fator de dificuldade (1-5): mat√©rias mais dif√≠ceis precisam de mais tempo
            const fatorDificuldade = 0.8 + (dificuldade / 10) * 0.8; // Varia de 0.8 a 1.6
            
            // Fator de extens√£o (1-6): mat√©rias mais extensas precisam de mais tempo
            const fatorExtensao = 0.8 + (extensao / 15) * 0.8; // Varia de 0.8 a 1.33
            
            // Calcular dura√ß√£o final
            let duracao = Math.round(duracaoBase * fatorImportancia * fatorDificuldade * fatorExtensao);
            
            // Aplicar limites
            duracao = Math.max(15, Math.min(tempoMaximoPorSessao, duracao));
            
            // Garantir que seja m√∫ltiplo de 5 minutos para facilitar
            return Math.round(duracao / 5) * 5;
        }

        // Fun√ß√£o para calcular sess√µes semanais
        function calcularSessoesPorDia() {
            const horasSegSex = parseFloat(document.getElementById('horasSegSex').value) || 2;
            const horasSabado = parseFloat(document.getElementById('horasSabado').value) || 4;
            const horasDomingo = parseFloat(document.getElementById('horasDomingo').value) || 3;
            const duracaoSessao = parseInt(document.getElementById('duracaoSessao').value) || 45;
            
            const horasSemanais = (horasSegSex * 5) + horasSabado + horasDomingo;
            const minutosSemanais = horasSemanais * 60;
            const sessoesSemanais = Math.floor(minutosSemanais / duracaoSessao);
            
            const tempoLiquido = (sessoesSemanais * duracaoSessao) / 60;
            
            document.getElementById('horasSemanais').textContent = horasSemanais.toFixed(1);
            document.getElementById('sessoesSemanais').textContent = sessoesSemanais;
            document.getElementById('tempoLiquido').textContent = formatarTempo(tempoLiquido);
        }

        // Fun√ß√£o para formatar tempo
        function formatarTempo(horas) {
            const h = Math.floor(horas);
            const m = Math.round((horas - h) * 60);
            return `${h}h${m.toString().padStart(2, '0')}`;
        }

        // Fun√ß√£o para adicionar mat√©ria
        function adicionarMateria() {
            const selectMateria = document.getElementById('nomeMateria');
            const inputCustomizado = document.getElementById('materiaCustomizada');
            const importanciaMateria = document.getElementById('importanciaMateria');
            const dificuldadeMateria = document.getElementById('dificuldadeMateria');
            const extensaoMateria = document.getElementById('extensaoMateria');
            
            let nome = '';
            if (selectMateria.value === '‚úèÔ∏è Digitar outra mat√©ria') {
                nome = inputCustomizado.value.trim();
            } else {
                nome = selectMateria.value;
            }
            
            if (!nome) {
                alert('‚ùå Por favor, selecione ou digite o nome da mat√©ria');
                return;
            }

            // Verifica se j√° existe
            if (materias.some(m => m.nome === nome)) {
                alert('‚ö†Ô∏è Esta mat√©ria j√° foi adicionada!');
                return;
            }

            const importancia = parseInt(importanciaMateria.value);
            const dificuldade = parseInt(dificuldadeMateria.value);
            const extensao = parseInt(extensaoMateria.value);
            const pontuacao = Math.pow(importancia, 1.5) * Math.pow(dificuldade, 1.2) * Math.pow(extensao, 1.1);
            const duracaoSessao = calcularDuracaoSessao(importancia, dificuldade, extensao);
            
            const materia = {
                nome,
                importancia,
                dificuldade,
                extensao,
                pontuacao,
                duracaoSessao,
                sessoes: 0
            };

            materias.push(materia);
            salvarDados();
            atualizarTabela();
            atualizarSelectsMaterias();
            limparFormulario();
            
            alert(`‚úÖ "${nome}" adicionada! Dura√ß√£o: ${duracaoSessao}min`);
        }

        function limparFormulario() {
            document.getElementById('nomeMateria').value = '';
            document.getElementById('materiaCustomizada').value = '';
            document.getElementById('materiaCustomizada').style.display = 'none';
            document.getElementById('importanciaMateria').value = '5';
            document.getElementById('dificuldadeMateria').value = '3';
            document.getElementById('extensaoMateria').value = '3';
        }

        function removerMateria(index) {
            if (confirm('Tem certeza que deseja remover esta mat√©ria?')) {
                materias.splice(index, 1);
                salvarDados();
                atualizarTabela();
                atualizarSelectsMaterias();
                
                // Se h√° um ciclo gerado, regenerar
                if (cicloAtual.length > 0) {
                    gerarCiclo();
                }
            }
        }

        function limparTudo() {
            if (confirm('Tem certeza que deseja limpar todas as mat√©rias e reiniciar?')) {
                materias = [];
                cicloAtual = [];
                sessaoAtualIndex = 0;
                
                salvarDados();
                atualizarTabela();
                atualizarSelectsMaterias();
                atualizarVisualizacaoCiclo();
                
                alert('Dados limpos com sucesso!');
            }
        }

        // Fun√ß√£o para calcular sess√µes por mat√©ria
        function calcularSessoesPorMateria() {
            const sessoesSemanais = parseInt(document.getElementById('sessoesSemanais').textContent) || 10;
            const totalPontuacao = materias.reduce((sum, m) => sum + m.pontuacao, 0);
            
            // Garantir que cada mat√©ria tenha pelo menos uma frequ√™ncia m√≠nima
            const frequenciaMinima = Math.max(2, Math.ceil(sessoesSemanais / 10));
            const frequenciaMaxima = Math.ceil(sessoesSemanais / 2);
            
            let sessoesTotais = 0;
            
            materias.forEach(materia => {
                const percentual = materia.pontuacao / totalPontuacao;
                const sessoesCalculadas = Math.round(percentual * sessoesSemanais);
                
                // Aplicar limites m√≠nimo e m√°ximo
                materia.sessoes = Math.max(frequenciaMinima, Math.min(frequenciaMaxima, sessoesCalculadas));
                sessoesTotais += materia.sessoes;
            });
            
            // Se o total ficou muito diferente do planejado, ajustar proporcionalmente
            if (sessoesTotais > sessoesSemanais * 1.2) {
                const fatorAjuste = (sessoesSemanais * 1.1) / sessoesTotais;
                materias.forEach(materia => {
                    materia.sessoes = Math.max(frequenciaMinima, Math.round(materia.sessoes * fatorAjuste));
                });
            }
        }

        // Fun√ß√£o para gerar ciclo
        function gerarCiclo() {
            if (materias.length === 0) {
                alert('‚ùå Adicione pelo menos uma mat√©ria antes de gerar o ciclo');
                return;
            }

            calcularSessoesPorMateria();
            
            // Criar ciclo
            cicloAtual = [];
            
            materias.forEach(materia => {
                for (let i = 0; i < materia.sessoes; i++) {
                    cicloAtual.push({
                        materia: materia.nome,
                        dificuldade: materia.dificuldade,
                        importancia: materia.importancia,
                        extensao: materia.extensao,
                        duracao: materia.duracaoSessao,
                        concluida: false
                    });
                }
            });

            // Embaralhar ciclo
            embaralharCiclo();
            
            sessaoAtualIndex = 0;
            
            // Salvar dados
            salvarDados();
            
            // Atualizar interface
            atualizarTabela();
            atualizarVisualizacaoCiclo();
            atualizarSelectsMaterias();
            
            const primeiraSessao = cicloAtual[0];
            alert(`üéâ Ciclo gerado com sucesso!\n\nüìä Total: ${cicloAtual.length} sess√µes\n‚è±Ô∏è Tempo total: ${(cicloAtual.reduce((sum, s) => sum + s.duracao, 0) / 60).toFixed(1)}h\n\nüéØ Primeira sess√£o:\n${primeiraSessao.materia} (${primeiraSessao.duracao}min)`);
        }

        // Fun√ß√£o para embaralhar ciclo com intercala√ß√£o otimizada
        function embaralharCiclo() {
            const materiasPorNome = {};
            cicloAtual.forEach(sessao => {
                if (!materiasPorNome[sessao.materia]) {
                    materiasPorNome[sessao.materia] = [];
                }
                materiasPorNome[sessao.materia].push(sessao);
            });

            const resultado = [];
            const nomes = Object.keys(materiasPorNome);
            const ultimaPosicao = {};
            const intervalosIdeal = {};
            
            // Calcular intervalo ideal baseado na import√¢ncia da mat√©ria
            nomes.forEach(nome => {
                const sessoesDaMateria = materiasPorNome[nome];
                const importanciaMedia = sessoesDaMateria.reduce((sum, s) => sum + s.importancia, 0) / sessoesDaMateria.length;
                
                // Mat√©rias mais importantes aparecem com mais frequ√™ncia
                let intervaloBase;
                if (importanciaMedia >= 8) {
                    // Muito importantes: a cada 3-4 sess√µes
                    intervaloBase = Math.max(3, Math.floor(cicloAtual.length / sessoesDaMateria.length / 1.5));
                } else if (importanciaMedia >= 6) {
                    // M√©dias: a cada 5-6 sess√µes
                    intervaloBase = Math.max(4, Math.floor(cicloAtual.length / sessoesDaMateria.length));
                } else {
                    // Menos importantes: a cada 7-8 sess√µes (m√°ximo)
                    intervaloBase = Math.max(5, Math.floor(cicloAtual.length / sessoesDaMateria.length * 1.2));
                }
                
                // Garantir que n√£o passe de 8 sess√µes sem aparecer
                intervalosIdeal[nome] = Math.min(intervaloBase, 8);
                ultimaPosicao[nome] = -intervalosIdeal[nome];
            });

            // Distribuir sess√µes respeitando as regras de intercala√ß√£o
            for (let posicao = 0; posicao < cicloAtual.length; posicao++) {
                let melhorMateria = null;
                let melhorPrioridade = -1;
                
                // Encontrar a melhor mat√©ria para esta posi√ß√£o
                nomes.forEach(nome => {
                    const sessoesDaMateria = materiasPorNome[nome];
                    if (sessoesDaMateria.length === 0) return;
                    
                    const intervaloAtual = posicao - ultimaPosicao[nome];
                    const intervaloMinimo = intervalosIdeal[nome];
                    
                    // Regra 1: N√£o pode ser a mesma mat√©ria da posi√ß√£o anterior
                    if (posicao > 0 && resultado[posicao - 1].materia === nome) {
                        return; // Pular esta mat√©ria
                    }
                    
                    // Calcular prioridade baseada na urg√™ncia e import√¢ncia
                    let prioridade = 0;
                    
                    if (intervaloAtual >= intervaloMinimo) {
                        const sessao = sessoesDaMateria[0];
                        
                        // Fator de urg√™ncia: quanto mais tempo sem aparecer, maior a urg√™ncia
                        const urgencia = Math.min(intervaloAtual / intervaloMinimo, 3);
                        
                        // Prioridade baseada em import√¢ncia, dificuldade e urg√™ncia
                        prioridade = (sessao.importancia * 2 + sessao.dificuldade + sessao.extensao) * urgencia;
                        
                        // Bonus extra para mat√©rias que est√£o h√° muito tempo sem aparecer
                        if (intervaloAtual > intervaloMinimo * 1.5) {
                            prioridade *= 2;
                        }
                        
                        // Bonus para mat√©rias muito importantes que n√£o podem ficar muito tempo sem aparecer
                        if (sessao.importancia >= 8 && intervaloAtual >= 4) {
                            prioridade *= 1.8;
                        }
                        
                        // Penalidade para mat√©rias que apareceram recentemente
                        if (intervaloAtual < intervaloMinimo) {
                            prioridade *= 0.1;
                        }
                    } else {
                        // Se ainda n√£o chegou no intervalo m√≠nimo, dar prioridade baixa
                        const sessao = sessoesDaMateria[0];
                        
                        // S√≥ considerar se for muito urgente (mais de 8 sess√µes sem aparecer)
                        if (intervaloAtual > 8) {
                            prioridade = sessao.importancia * 0.5;
                        }
                    }
                    
                    if (prioridade > melhorPrioridade) {
                        melhorPrioridade = prioridade;
                        melhorMateria = nome;
                    }
                });
                
                // Se n√£o encontrou nenhuma mat√©ria adequada, for√ßar a que est√° h√° mais tempo
                if (!melhorMateria) {
                    let maiorIntervalo = -1;
                    nomes.forEach(nome => {
                        const sessoesDaMateria = materiasPorNome[nome];
                        if (sessoesDaMateria.length > 0) {
                            const intervaloAtual = posicao - ultimaPosicao[nome];
                            
                            // Evitar repetir a mat√©ria anterior, mas permitir se for muito urgente
                            const materiaAnterior = posicao > 0 ? resultado[posicao - 1].materia : null;
                            if (nome === materiaAnterior && intervaloAtual < 8) {
                                return; // S√≥ permitir repetir se passou de 8 sess√µes
                            }
                            
                            if (intervaloAtual > maiorIntervalo) {
                                maiorIntervalo = intervaloAtual;
                                melhorMateria = nome;
                            }
                        }
                    });
                }
                
                // Adicionar a sess√£o da mat√©ria escolhida
                if (melhorMateria && materiasPorNome[melhorMateria].length > 0) {
                    const sessao = materiasPorNome[melhorMateria].shift();
                    resultado.push(sessao);
                    ultimaPosicao[melhorMateria] = posicao;
                } else {
                    // Fallback: pegar qualquer mat√©ria dispon√≠vel
                    for (let nome of nomes) {
                        if (materiasPorNome[nome].length > 0) {
                            const sessao = materiasPorNome[nome].shift();
                            resultado.push(sessao);
                            ultimaPosicao[nome] = posicao;
                            break;
                        }
                    }
                }
            }

            cicloAtual = resultado;
        }

        // Fun√ß√£o para atualizar tabela
        function atualizarTabela() {
            const tbody = document.querySelector('#tabelaMaterias tbody');
            tbody.innerHTML = '';

            materias.forEach((materia, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${materia.nome}</td>
                    <td>${materia.importancia}</td>
                    <td>${materia.dificuldade}</td>
                    <td>${materia.extensao}</td>
                    <td>${materia.pontuacao.toFixed(1)}</td>
                    <td>${materia.duracaoSessao}min</td>
                    <td>${materia.sessoes || 0}</td>
                    <td>
                        <button class="btn btn-danger" onclick="removerMateria(${index})" 
                                style="padding: 8px 12px; margin: 0; font-size: 12px;">‚ùå</button>
                    </td>
                `;
            });
        }

        // Fun√ß√£o para atualizar visualiza√ß√£o do ciclo
        function atualizarVisualizacaoCiclo() {
            const container = document.getElementById('cicloContainer');
            
            if (cicloAtual.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d; font-style: italic;">Adicione mat√©rias e clique em "Gerar Ciclo" para come√ßar</p>';
                return;
            }

            let html = '';
            
            cicloAtual.forEach((sessao, index) => {
                const isAtual = index === sessaoAtualIndex;
                const isConcluida = sessao.concluida;
                
                let classe = '';
                if (isConcluida) classe = 'concluido';
                else if (isAtual) classe = 'atual';
                
                let icone = '';
                switch(sessao.dificuldade) {
                    case 5: icone = 'üî¥'; break;
                    case 4: icone = 'üü†'; break;
                    case 3: icone = 'üü°'; break;
                    case 2: icone = 'üü¢'; break;
                    case 1: icone = 'üîµ'; break;
                }

                const status = isConcluida ? '‚úÖ' : (isAtual ? 'üëâ' : '‚è≥');
                
                html += `
                    <div class="ciclo-item ${classe}">
                        <div class="ciclo-info">
                            <h4>${status} ${icone} ${sessao.materia}</h4>
                            <small>Sess√£o ${index + 1} de ${cicloAtual.length} | Import√¢ncia: ${sessao.importancia} | Dificuldade: ${sessao.dificuldade} | Extens√£o: ${sessao.extensao}</small>
                        </div>
                        <div class="ciclo-tempo ${classe}">${sessao.duracao}min</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Fun√ß√£o para atualizar selects de mat√©rias nos cron√¥metros
        function atualizarSelectsMaterias() {
            const selectLivre = document.getElementById('materiaLivre');
            const selectPomodoro = document.getElementById('materiaPomodoro');
            
            // Limpar op√ß√µes existentes (exceto "Outra Mat√©ria")
            selectLivre.innerHTML = '<option value="Outra Mat√©ria">Outra Mat√©ria</option>';
            selectPomodoro.innerHTML = '<option value="Outra Mat√©ria">Outra Mat√©ria</option>';
            
            // Adicionar mat√©rias cadastradas
            materias.forEach(materia => {
                const optionLivre = document.createElement('option');
                optionLivre.value = materia.nome;
                optionLivre.textContent = materia.nome;
                selectLivre.appendChild(optionLivre);
                
                const optionPomodoro = document.createElement('option');
                optionPomodoro.value = materia.nome;
                optionPomodoro.textContent = materia.nome;
                selectPomodoro.appendChild(optionPomodoro);
            });
        }

        // Fun√ß√£o para atualizar inputs do Pomodoro
        function atualizarInputsPomodoro() {
            const tempoEstudo = document.getElementById('tempoEstudoPomodoro');
            const tempoPausa = document.getElementById('tempoPausaPomodoro');
            const tempoLivreInput = document.getElementById('tempoLivreInput');
            
            // Atualizar meta do tempo livre quando o input mudar
            tempoLivreInput.addEventListener('input', function() {
                const tempo = parseInt(this.value) || 30;
                document.getElementById('metaLivre').textContent = `Meta: ${formatarTempoMM(tempo * 60)}`;
            });
            
            // Atualizar configura√ß√£o do Pomodoro quando os inputs mudarem
            tempoEstudo.addEventListener('input', atualizarConfigPomodoro);
            tempoPausa.addEventListener('input', atualizarConfigPomodoro);
        }

        function atualizarConfigPomodoro() {
            const tempoEstudo = parseInt(document.getElementById('tempoEstudoPomodoro').value) || 25;
            const tempoPausa = parseInt(document.getElementById('tempoPausaPomodoro').value) || 5;
            
            cronometros.pomodoro.tempoEstudo = tempoEstudo;
            cronometros.pomodoro.tempoPausa = tempoPausa;
            
            document.getElementById('fasePomodoro').textContent = `${tempoEstudo}min estudo ‚Üí ${tempoPausa}min pausa`;
            
            // Se n√£o estiver ativo, atualizar o display
            if (!cronometros.pomodoro.ativo) {
                document.getElementById('tempoPomodoro').textContent = formatarTempoMM(tempoEstudo * 60);
            }
        }

        // ===== FUN√á√ïES DOS CRON√îMETROS =====

        // Cron√¥metro Meta de Estudos
        function iniciarCronometroMeta() {
            if (cicloAtual.length === 0) {
                alert('‚ùå Gere um ciclo primeiro!');
                return;
            }
            
            if (sessaoAtualIndex >= cicloAtual.length) {
                alert('üéâ Ciclo conclu√≠do! Gere um novo ciclo para continuar.');
                return;
            }
            
            const sessaoAtual = cicloAtual[sessaoAtualIndex];
            cronometros.meta.sessaoAtual = sessaoAtual;
            cronometros.meta.tempoMeta = sessaoAtual.duracao * 60;
            
            if (!cronometros.meta.ativo) {
                cronometros.meta.tempoInicio = Date.now();
                cronometros.meta.tempoDecorrido = 0;
            } else if (cronometros.meta.pausado) {
                cronometros.meta.tempoInicio = Date.now() - cronometros.meta.tempoDecorrido;
            }
            
            cronometros.meta.ativo = true;
            cronometros.meta.pausado = false;
            
            // Atualizar interface
            document.getElementById('btnPlayMeta').disabled = true;
            document.getElementById('btnPauseMeta').disabled = false;
            document.getElementById('btnStopMeta').disabled = false;
            document.getElementById('btnCompleteMeta').disabled = false;
            
            document.getElementById('infoMeta').textContent = `üìö Estudando: ${sessaoAtual.materia}`;
            document.getElementById('metaMeta').textContent = `Meta: ${formatarTempoMM(cronometros.meta.tempoMeta)}`;
            document.getElementById('cronometroMeta').classList.add('ativo');
            
            // Iniciar intervalo
            cronometros.meta.intervalo = setInterval(() => atualizarCronometro('meta'), 1000);
            atualizarCronometro('meta');
        }

        function pausarCronometroMeta() {
            if (!cronometros.meta.ativo) return;
            
            cronometros.meta.pausado = true;
            clearInterval(cronometros.meta.intervalo);
            
            document.getElementById('btnPlayMeta').disabled = false;
            document.getElementById('btnPauseMeta').disabled = true;
            document.getElementById('cronometroMeta').classList.remove('ativo');
        }

        function pararCronometroMeta() {
            if (!cronometros.meta.ativo && !cronometros.meta.pausado) return;
            
            cronometros.meta.ativo = false;
            cronometros.meta.pausado = false;
            clearInterval(cronometros.meta.intervalo);
            
            cronometros.meta.tempoDecorrido = 0;
            cronometros.meta.tempoMeta = 0;
            cronometros.meta.sessaoAtual = null;
            
            document.getElementById('btnPlayMeta').disabled = false;
            document.getElementById('btnPauseMeta').disabled = true;
            document.getElementById('btnStopMeta').disabled = true;
            document.getElementById('btnCompleteMeta').disabled = true;
            
            document.getElementById('tempoMeta').textContent = '00:00';
            document.getElementById('infoMeta').textContent = 'Pr√≥xima sess√£o: Clique em Iniciar';
            document.getElementById('metaMeta').textContent = 'Meta: --:--';
            document.getElementById('cronometroMeta').classList.remove('ativo');
        }

        function completarSessaoMeta() {
            if (!cronometros.meta.ativo && !cronometros.meta.pausado) return;
            
            const tempoEstudado = Math.ceil(cronometros.meta.tempoDecorrido / 60000);
            
            pararCronometroMeta();
            
            if (tempoEstudado >= 5) {
                const sessao = cicloAtual[sessaoAtualIndex];
                if (sessao) {
                    registrarSessao(sessao.materia, tempoEstudado);
                    marcarConcluida();
                }
            } else {
                alert('‚ö†Ô∏è Sess√£o muito curta! Estude pelo menos 5 minutos para registrar.');
            }
            
            atualizarEstatisticasDia();
        }

        // Cron√¥metro Tempo Livre
        function iniciarCronometroLivre() {
            const tempoInput = parseInt(document.getElementById('tempoLivreInput').value) || 30;
            const materia = document.getElementById('materiaLivre').value;
            
            cronometros.livre.materiaAtual = materia;
            cronometros.livre.tempoMeta = tempoInput * 60;
            
            if (!cronometros.livre.ativo) {
                cronometros.livre.tempoInicio = Date.now();
                cronometros.livre.tempoDecorrido = 0;
            } else if (cronometros.livre.pausado) {
                cronometros.livre.tempoInicio = Date.now() - cronometros.livre.tempoDecorrido;
            }
            
            cronometros.livre.ativo = true;
            cronometros.livre.pausado = false;
            
            document.getElementById('btnPlayLivre').disabled = true;
            document.getElementById('btnPauseLivre').disabled = false;
            document.getElementById('btnStopLivre').disabled = false;
            document.getElementById('btnCompleteLivre').disabled = false;
            document.getElementById('cronometroLivre').classList.add('ativo');
            
            cronometros.livre.intervalo = setInterval(() => atualizarCronometro('livre'), 1000);
            atualizarCronometro('livre');
        }

        function pausarCronometroLivre() {
            if (!cronometros.livre.ativo) return;
            
            cronometros.livre.pausado = true;
            clearInterval(cronometros.livre.intervalo);
            
            document.getElementById('btnPlayLivre').disabled = false;
            document.getElementById('btnPauseLivre').disabled = true;
            document.getElementById('cronometroLivre').classList.remove('ativo');
        }

        function pararCronometroLivre() {
            if (!cronometros.livre.ativo && !cronometros.livre.pausado) return;
            
            cronometros.livre.ativo = false;
            cronometros.livre.pausado = false;
            clearInterval(cronometros.livre.intervalo);
            
            cronometros.livre.tempoDecorrido = 0;
            cronometros.livre.tempoMeta = 0;
            cronometros.livre.materiaAtual = null;
            
            document.getElementById('btnPlayLivre').disabled = false;
            document.getElementById('btnPauseLivre').disabled = true;
            document.getElementById('btnStopLivre').disabled = true;
            document.getElementById('btnCompleteLivre').disabled = true;
            
            document.getElementById('tempoLivre').textContent = '00:00';
            document.getElementById('cronometroLivre').classList.remove('ativo');
        }

        function completarSessaoLivre() {
            if (!cronometros.livre.ativo && !cronometros.livre.pausado) return;
            
            const tempoEstudado = Math.ceil(cronometros.livre.tempoDecorrido / 60000);
            const materia = cronometros.livre.materiaAtual;
            
            pararCronometroLivre();
            
            if (tempoEstudado >= 5) {
                registrarSessao(materia, tempoEstudado);
            } else {
                alert('‚ö†Ô∏è Sess√£o muito curta! Estude pelo menos 5 minutos para registrar.');
            }
            
            atualizarEstatisticasDia();
        }

        // Cron√¥metro Pomodoro
        function iniciarCronometroPomodoro() {
            const materia = document.getElementById('materiaPomodoro').value;
            cronometros.pomodoro.materiaAtual = materia;
            
            // Definir tempo baseado na fase atual
            const tempoFase = cronometros.pomodoro.faseAtual === 'estudo' ? 
                cronometros.pomodoro.tempoEstudo : cronometros.pomodoro.tempoPausa;
            cronometros.pomodoro.tempoMeta = tempoFase * 60;
            
            if (!cronometros.pomodoro.ativo) {
                cronometros.pomodoro.tempoInicio = Date.now();
                cronometros.pomodoro.tempoDecorrido = 0;
            } else if (cronometros.pomodoro.pausado) {
                cronometros.pomodoro.tempoInicio = Date.now() - cronometros.pomodoro.tempoDecorrido;
            }
            
            cronometros.pomodoro.ativo = true;
            cronometros.pomodoro.pausado = false;
            
            document.getElementById('btnPlayPomodoro').disabled = true;
            document.getElementById('btnPausePomodoro').disabled = false;
            document.getElementById('btnStopPomodoro').disabled = false;
            document.getElementById('btnPularPomodoro').disabled = false;
            document.getElementById('cronometroPomodoro').classList.add('ativo');
            
            cronometros.pomodoro.intervalo = setInterval(() => atualizarCronometro('pomodoro'), 1000);
            atualizarCronometro('pomodoro');
        }

        function pausarCronometroPomodoro() {
            if (!cronometros.pomodoro.ativo) return;
            
            cronometros.pomodoro.pausado = true;
            clearInterval(cronometros.pomodoro.intervalo);
            
            document.getElementById('btnPlayPomodoro').disabled = false;
            document.getElementById('btnPausePomodoro').disabled = true;
            document.getElementById('cronometroPomodoro').classList.remove('ativo');
        }

        function pararCronometroPomodoro() {
            if (!cronometros.pomodoro.ativo && !cronometros.pomodoro.pausado) return;
            
            // Se estava em fase de estudo, registrar o tempo
            if (cronometros.pomodoro.faseAtual === 'estudo') {
                const tempoEstudado = Math.ceil(cronometros.pomodoro.tempoDecorrido / 60000);
                if (tempoEstudado >= 5) {
                    registrarSessao(cronometros.pomodoro.materiaAtual, tempoEstudado);
                    cronometros.pomodoro.tempoFocoHoje += tempoEstudado;
                }
            }
            
            cronometros.pomodoro.ativo = false;
            cronometros.pomodoro.pausado = false;
            clearInterval(cronometros.pomodoro.intervalo);
            
            cronometros.pomodoro.tempoDecorrido = 0;
            cronometros.pomodoro.faseAtual = 'estudo';
            cronometros.pomodoro.tempoMeta = cronometros.pomodoro.tempoEstudo * 60;
            
            document.getElementById('btnPlayPomodoro').disabled = false;
            document.getElementById('btnPausePomodoro').disabled = true;
            document.getElementById('btnStopPomodoro').disabled = true;
            document.getElementById('btnPularPomodoro').disabled = true;
            
            document.getElementById('tempoPomodoro').textContent = formatarTempoMM(cronometros.pomodoro.tempoEstudo * 60);
            document.getElementById('cicloPomodoro').textContent = `Ciclo: ${cronometros.pomodoro.cicloAtual} | Fase: Estudo`;
            document.getElementById('cronometroPomodoro').classList.remove('ativo');
            
            atualizarEstatisticasDia();
            atualizarStatsPomodoro();
        }

        function pularFasePomodoro() {
            if (!cronometros.pomodoro.ativo && !cronometros.pomodoro.pausado) return;
            
            // Se estava em fase de estudo, registrar o tempo
            if (cronometros.pomodoro.faseAtual === 'estudo') {
                const tempoEstudado = Math.ceil(cronometros.pomodoro.tempoDecorrido / 60000);
                if (tempoEstudado >= 5) {
                    registrarSessao(cronometros.pomodoro.materiaAtual, tempoEstudado);
                    cronometros.pomodoro.tempoFocoHoje += tempoEstudado;
                    cronometros.pomodoro.pomodorosHoje++;
                }
            }
            
            // Alternar fase
            if (cronometros.pomodoro.faseAtual === 'estudo') {
                cronometros.pomodoro.faseAtual = 'pausa';
                cronometros.pomodoro.tempoMeta = cronometros.pomodoro.tempoPausa * 60;
            } else {
                cronometros.pomodoro.faseAtual = 'estudo';
                cronometros.pomodoro.tempoMeta = cronometros.pomodoro.tempoEstudo * 60;
                cronometros.pomodoro.cicloAtual++;
            }
            
            // Reiniciar cron√¥metro para nova fase
            cronometros.pomodoro.tempoInicio = Date.now();
            cronometros.pomodoro.tempoDecorrido = 0;
            
            // Atualizar interface
            const fase = cronometros.pomodoro.faseAtual === 'estudo' ? 'Estudo' : 'Pausa';
            document.getElementById('cicloPomodoro').textContent = `Ciclo: ${cronometros.pomodoro.cicloAtual} | Fase: ${fase}`;
            
            atualizarEstatisticasDia();
            atualizarStatsPomodoro();
        }

        // Fun√ß√£o universal para atualizar cron√¥metros
        function atualizarCronometro(tipo) {
            const cronometro = cronometros[tipo];
            if (!cronometro.ativo) return;
            
            cronometro.tempoDecorrido = Date.now() - cronometro.tempoInicio;
            
            let tempoDisplay;
            if (tipo === 'pomodoro' && cronometro.contadorRegressivo) {
                // Pomodoro com contador regressivo
                const tempoRestante = Math.max(0, cronometro.tempoMeta - Math.floor(cronometro.tempoDecorrido / 1000));
                tempoDisplay = tempoRestante;
            } else {
                // Cron√¥metro normal (progressivo)
                tempoDisplay = Math.floor(cronometro.tempoDecorrido / 1000);
            }
            
            // Atualizar display
            const elementoTempo = document.getElementById(`tempo${tipo.charAt(0).toUpperCase() + tipo.slice(1)}`);
            if (elementoTempo) {
                elementoTempo.textContent = formatarTempoMM(tempoDisplay);
            }
            
            // Verificar se atingiu a meta (para Pomodoro)
            if (tipo === 'pomodoro' && cronometro.tempoDecorrido >= cronometro.tempoMeta * 1000) {
                // Auto-pular fase no Pomodoro
                pularFasePomodoro();
            }
        }

        function formatarTempoMM(segundos) {
            const mins = Math.floor(segundos / 60);
            const secs = segundos % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // Fun√ß√£o para marcar sess√£o como conclu√≠da
        function marcarConcluida() {
            if (cicloAtual.length === 0) {
                alert('Gere um ciclo primeiro!');
                return;
            }
            
            if (sessaoAtualIndex >= cicloAtual.length) {
                alert('Ciclo conclu√≠do! Gere um novo ciclo para continuar.');
                return;
            }
            
            const sessaoAtual = cicloAtual[sessaoAtualIndex];
            
            if (sessaoAtual.concluida) {
                alert('Esta sess√£o j√° foi conclu√≠da!');
                return;
            }
            
            // Marcar como conclu√≠da
            sessaoAtual.concluida = true;
            
            // Avan√ßar para pr√≥xima sess√£o
            sessaoAtualIndex++;
            
            // Verificar se ciclo foi conclu√≠do
            if (sessaoAtualIndex >= cicloAtual.length) {
                alert('üéâ Parab√©ns! Voc√™ completou um ciclo! Gere um novo ciclo para continuar.');
                return;
            }
            
            // Salvar e atualizar interface
            salvarDados();
            atualizarVisualizacaoCiclo();
            
            // Mostrar pr√≥xima sess√£o
            const proximaSessao = cicloAtual[sessaoAtualIndex];
            alert(`‚úÖ Sess√£o conclu√≠da!\n\nüéØ Pr√≥xima sess√£o: ${proximaSessao.materia}\n‚è±Ô∏è Dura√ß√£o: ${proximaSessao.duracao} minutos`);
        }

        // Fun√ß√£o para registrar sess√£o no hist√≥rico
        function registrarSessao(materia, duracao) {
            const registro = {
                materia: materia,
                duracao: duracao,
                data: new Date().toISOString(),
                timestamp: Date.now()
            };
            
            historicoEstudos.push(registro);
            
            // Atualizar estat√≠sticas gerais
            estatisticasGerais.totalSessoes++;
            estatisticasGerais.totalTempo += duracao;
            
            if (!estatisticasGerais.tempoTotalPorMateria[materia]) {
                estatisticasGerais.tempoTotalPorMateria[materia] = 0;
            }
            estatisticasGerais.tempoTotalPorMateria[materia] += duracao;
            
            // Salvar automaticamente
            salvarDados();
            atualizarHistorico();
            atualizarMateriasHoje();
        }

        // Fun√ß√£o para atualizar estat√≠sticas do dia
        function atualizarEstatisticasDia() {
            const hoje = new Date().toDateString();
            
            // Filtrar sess√µes de hoje
            const sessoesHoje = historicoEstudos.filter(sessao => {
                const dataSessao = new Date(sessao.data).toDateString();
                return dataSessao === hoje;
            });
            
            // Calcular estat√≠sticas
            const tempoTotal = sessoesHoje.reduce((total, sessao) => total + sessao.duracao, 0);
            const quantidadeSessoes = sessoesHoje.length;
            const materiasUnicas = new Set(sessoesHoje.map(s => s.materia)).size;
            
            // Calcular meta di√°ria (baseado nas horas dispon√≠veis)
            const horasSegSex = parseFloat(document.getElementById('horasSegSex').value) || 2;
            const horasSabado = parseFloat(document.getElementById('horasSabado').value) || 4;
            const horasDomingo = parseFloat(document.getElementById('horasDomingo').value) || 3;
            
            const diaSemana = new Date().getDay();
            let metaDiaria;
            if (diaSemana === 0) { // Domingo
                metaDiaria = horasDomingo * 60;
            } else if (diaSemana === 6) { // S√°bado
                metaDiaria = horasSabado * 60;
            } else { // Segunda a Sexta
                metaDiaria = horasSegSex * 60;
            }
            
            const percentualMeta = metaDiaria > 0 ? Math.round((tempoTotal / metaDiaria) * 100) : 0;
            
            // Atualizar interface
            const horas = Math.floor(tempoTotal / 60);
            const minutos = tempoTotal % 60;
            
            document.getElementById('tempoTotalHoje').textContent = `${horas}h${minutos.toString().padStart(2, '0')}min`;
            document.getElementById('sessoesHoje').textContent = quantidadeSessoes;
            document.getElementById('materiasHoje').textContent = materiasUnicas;
            document.getElementById('metaDiaria').textContent = `${percentualMeta}%`;
        }

        // Fun√ß√£o para atualizar stats do Pomodoro
        function atualizarStatsPomodoro() {
            document.getElementById('pomodorosHoje').textContent = cronometros.pomodoro.pomodorosHoje;
            document.getElementById('tempoFocoHoje').textContent = `${cronometros.pomodoro.tempoFocoHoje}min`;
        }

        // Fun√ß√£o para atualizar hist√≥rico
        function atualizarHistorico() {
            const historicoSection = document.getElementById('historicoSection');
            
            if (historicoEstudos.length === 0) {
                historicoSection.style.display = 'none';
                return;
            }
            
            historicoSection.style.display = 'block';
            
            // Atualizar estat√≠sticas
            const estatisticasDiv = document.getElementById('historicoEstatisticas');
            const totalHoras = (estatisticasGerais.totalTempo / 60).toFixed(1);
            const mediaPorDia = historicoEstudos.length > 0 ? 
                (estatisticasGerais.totalTempo / getDiasEstudados()).toFixed(0) : 0;
            
            estatisticasDiv.innerHTML = `
                <div class="stat-card">
                    <h3>${estatisticasGerais.totalSessoes}</h3>
                    <p>Sess√µes Conclu√≠das</p>
                </div>
                <div class="stat-card">
                    <h3>${totalHoras}h</h3>
                    <p>Tempo Total</p>
                </div>
                <div class="stat-card">
                    <h3>${mediaPorDia}min</h3>
                    <p>M√©dia por Dia</p>
                </div>
                <div class="stat-card">
                    <h3>${getDiasEstudados()}</h3>
                    <p>Dias Estudados</p>
                </div>
            `;
            
            // Atualizar lista de hist√≥rico
            const historicoLista = document.getElementById('historicoLista');
            const ultimasSessoes = historicoEstudos.slice(-20).reverse();
            
            let htmlHistorico = '';
            
            ultimasSessoes.forEach(sessao => {
                const data = new Date(sessao.data);
                const dataFormatada = data.toLocaleDateString('pt-BR');
                const horaFormatada = data.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                htmlHistorico += `
                    <div style="background: white; padding: 12px; margin: 8px 0; border-radius: 8px; border-left: 4px solid #4a5568; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${sessao.materia}</strong>
                            <br>
                            <small style="color: #6c757d;">${dataFormatada} √†s ${horaFormatada}</small>
                        </div>
                        <div style="text-align: right;">
                            <span style="background: #4a5568; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                                ${sessao.duracao}min
                            </span>
                        </div>
                    </div>
                `;
            });
            
            historicoLista.innerHTML = htmlHistorico;
        }

        // Fun√ß√£o para atualizar mat√©rias estudadas hoje
        function atualizarMateriasHoje() {
            const hoje = new Date().toDateString();
            const sessoesHoje = historicoEstudos.filter(sessao => {
                const dataSessao = new Date(sessao.data).toDateString();
                return dataSessao === hoje;
            });
            
            const materiasHojeSection = document.getElementById('materiasHojeSection');
            
            if (sessoesHoje.length === 0) {
                materiasHojeSection.style.display = 'none';
                return;
            }
            
            materiasHojeSection.style.display = 'block';
            
            // Agrupar sess√µes por mat√©ria
            const materiasPorNome = {};
            sessoesHoje.forEach(sessao => {
                if (!materiasPorNome[sessao.materia]) {
                    materiasPorNome[sessao.materia] = {
                        nome: sessao.materia,
                        sessoes: 0,
                        tempoTotal: 0,
                        ultimaSessao: null
                    };
                }
                materiasPorNome[sessao.materia].sessoes++;
                materiasPorNome[sessao.materia].tempoTotal += sessao.duracao;
                materiasPorNome[sessao.materia].ultimaSessao = new Date(sessao.data);
            });
            
            const materiasArray = Object.values(materiasPorNome);
            const tempoTotalHoje = sessoesHoje.reduce((total, sessao) => total + sessao.duracao, 0);
            
            // Ordenar por tempo total (maior primeiro)
            materiasArray.sort((a, b) => b.tempoTotal - a.tempoTotal);
            
            // Atualizar estat√≠sticas
            const estatisticasDiv = document.getElementById('materiasHojeEstatisticas');
            const horasHoje = (tempoTotalHoje / 60).toFixed(1);
            const materiasUnicas = materiasArray.length;
            const mediaPorMateria = materiasUnicas > 0 ? (tempoTotalHoje / materiasUnicas).toFixed(0) : 0;
            const maiorTempo = materiasArray.length > 0 ? materiasArray[0] : null;
            
            estatisticasDiv.innerHTML = `
                <div class="stat-card">
                    <h3>${horasHoje}h</h3>
                    <p>Tempo Total Hoje</p>
                </div>
                <div class="stat-card">
                    <h3>${materiasUnicas}</h3>
                    <p>Mat√©rias Diferentes</p>
                </div>
                <div class="stat-card">
                    <h3>${mediaPorMateria}min</h3>
                    <p>M√©dia por Mat√©ria</p>
                </div>
                <div class="stat-card">
                    <h3>${maiorTempo ? maiorTempo.nome : 'N/A'}</h3>
                    <p>Mat√©ria Mais Estudada</p>
                </div>
            `;
            
            // Criar gr√°fico de barras
            const graficoDiv = document.getElementById('materiasHojeGrafico');
            let htmlGrafico = '';
            
            materiasArray.forEach((materia, index) => {
                const percentual = (materia.tempoTotal / tempoTotalHoje) * 100;
                const tempoHoras = (materia.tempoTotal / 60).toFixed(1);
                const ultimaHora = materia.ultimaSessao.toLocaleTimeString('pt-BR', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                // Cores do gr√°fico
                const cores = [
                    '#4ade80', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6',
                    '#06b6d4', '#84cc16', '#f97316', '#ec4899', '#6366f1'
                ];
                const cor = cores[index % cores.length];
                
                htmlGrafico += `
                    <div style="background: white; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid ${cor}; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div>
                                <strong style="color: #2d3748; font-size: 16px;">${materia.nome}</strong>
                                <div style="color: #6c757d; font-size: 12px; margin-top: 2px;">
                                    ${materia.sessoes} sess√£o${materia.sessoes > 1 ? '√µes' : ''} ‚Ä¢ √öltima: ${ultimaHora}
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="background: ${cor}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                                    ${materia.tempoTotal}min
                                </div>
                                <div style="color: #6c757d; font-size: 11px; margin-top: 2px;">
                                    ${tempoHoras}h
                                </div>
                            </div>
                        </div>
                        <div style="background: #ecf0f1; border-radius: 10px; height: 8px; overflow: hidden;">
                            <div style="background: ${cor}; height: 100%; width: ${percentual}%; transition: width 0.3s ease; border-radius: 10px;"></div>
                        </div>
                        <div style="text-align: right; color: #6c757d; font-size: 11px; margin-top: 4px;">
                            ${percentual.toFixed(1)}% do tempo total
                        </div>
                    </div>
                `;
            });
            
            graficoDiv.innerHTML = htmlGrafico;
        }

        function getDiasEstudados() {
            if (historicoEstudos.length === 0) return 0;
            
            const datas = new Set();
            historicoEstudos.forEach(sessao => {
                const data = new Date(sessao.data).toDateString();
                datas.add(data);
            });
            
            return datas.size;
        }

        // Fun√ß√µes de salvamento autom√°tico
        function salvarDados() {
            const dados = {
                materias: materias,
                cicloAtual: cicloAtual,
                sessaoAtualIndex: sessaoAtualIndex,
                historicoEstudos: historicoEstudos,
                estatisticasGerais: estatisticasGerais,
                cronometros: cronometros,
                dataUltimaSalvamento: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('cronometroEstudos', JSON.stringify(dados));
            } catch (error) {
                console.warn('Erro ao salvar dados:', error);
            }
        }

        function carregarDados() {
            try {
                const dados = localStorage.getItem('cronometroEstudos');
                if (dados) {
                    const dadosCarregados = JSON.parse(dados);
                    
                    materias = dadosCarregados.materias || [];
                    cicloAtual = dadosCarregados.cicloAtual || [];
                    sessaoAtualIndex = dadosCarregados.sessaoAtualIndex || 0;
                    historicoEstudos = dadosCarregados.historicoEstudos || [];
                    estatisticasGerais = dadosCarregados.estatisticasGerais || {
                        totalSessoes: 0,
                        totalTempo: 0,
                        tempoTotalPorMateria: {}
                    };
                    
                    // Carregar dados dos cron√¥metros se existirem
                    if (dadosCarregados.cronometros) {
                        Object.assign(cronometros, dadosCarregados.cronometros);
                    }
                    
                    // Atualizar interface
                    atualizarTabela();
                    atualizarVisualizacaoCiclo();
                    atualizarHistorico();
                    atualizarMateriasHoje();
                }
            } catch (error) {
                console.warn('Erro ao carregar dados salvos:', error);
            }
        }
    </script>
</body>
</html>

